[33mcommit ba2044c4a1dc9f73f38e1f949ae927ecb699412b[m
Author: lijianhui <jianhuili@webot.co>
Date:   Wed Sep 27 14:37:49 2017 +0800

    当前会话列表倒叙

[1mdiff --git a/dist.zip b/dist.zip[m
[1mindex 66d9a35..20c65be 100644[m
Binary files a/dist.zip and b/dist.zip differ
[1mdiff --git a/src/page/servicer/main.vue b/src/page/servicer/main.vue[m
[1mindex 01c0456..cb2d3ba 100644[m
[1m--- a/src/page/servicer/main.vue[m
[1m+++ b/src/page/servicer/main.vue[m
[36m@@ -97,7 +97,7 @@[m
 		  	},[m
 			getSessionList(){[m
 				let v = this;[m
[31m-				v.$api.ajax('/chats','get').then(data=>{[m
[32m+[m				[32mv.$api.ajax('/chats','get',{sort:1}).then(data=>{[m
 					data.list.forEach((val,i)=>{[m
 						v.initSession(val);[m
 						v.ids[data.list[i].session_id]={[m
[36m@@ -375,7 +375,7 @@[m
 			},[m
 			获取会话历史(id,time=''){[m
 				let v = this;  [m
[31m-				let end_time = time?new Date(time).getTime()/100:'';[m
[32m+[m				[32mlet end_time = time?new Date(time).getTime()/1000:'';[m
 				return new Promise((resolve,reject)=>{[m
 					v.$api.ajaxNoLoading(v.$uri.session.log,'get',{session_id:id,end_time:end_time})[m
 					.then(data=>{[m
[1mdiff --git a/src/page/servicer/session.vue b/src/page/servicer/session.vue[m
[1mindex b88e18b..be12d54 100644[m
[1m--- a/src/page/servicer/session.vue[m
[1m+++ b/src/page/servicer/session.vue[m
[36m@@ -6,7 +6,7 @@[m
 					  	<el-collapse-item :title="'会话中('+getStatusNum(1)+')'" name="1" class="font14">[m
 						    <bar :wrapper="'wrapper'">[m
 								<ul>[m
[31m-									<li v-for="(session,i) in reverseSessions" v-if="session.status==1" @click="changeSession(i)" :class="current===i?'on':''" class="pointer" :index="i">[m
[32m+[m									[32m<li v-for="(session,i) in reverseSessions" v-if="session.status==1" @click="changeSession(sessions.length-i-1)" :class="current===sessions.length-i-1?'on':''" class="pointer" :index="sessions.length-i-1">[m
 										<span class="icon">[m
 											<template v-if="session.head && session.head!==''"><img :src="session.head" /></template>[m
 											<template v-else>{{session.session_id.slice(-2)}}</template>[m
[36m@@ -20,7 +20,7 @@[m
 											<p class="font14 opcity5" :title="session.tell.length>0?(session.tell[session.tell.length-1].question||session.tell[session.tell.length-1].answer):''"[m
 												v-html="session.tell_no_img.length>0?session.tell_no_img[session.tell_no_img.length-1].text:''">[m
 											</p>[m
[31m-											<span v-if="session.news.toString().slice(0,1)>0 && current!=i" class="pull-right" :class="(new Date().getTime()-new Date(session.tell_no_img[session.tell_no_img.length-1].time).getTime())>600000?'':'c1'">{{session.news}}</span>[m
[32m+[m											[32m<span v-if="session.news.toString().slice(0,1)>0 && current!=sessions.length-i-1" class="pull-right" :class="(new Date().getTime()-new Date(session.tell_no_img[session.tell_no_img.length-1].time).getTime())>600000?'':'c1'">{{session.news}}</span>[m
 										</div>[m
 									</li>[m
 								</ul>[m
[36m@@ -29,7 +29,7 @@[m
 					  	<el-collapse-item :title="'已结束('+getStatusNum(2)+')'" name="2">[m
 						    <bar :wrapper="'wrapper'">[m
 								<ul>[m
[31m-									<li v-for="(session,i) in reverseSessions" v-if="session.status==2" @click="changeSession(i)" :class="current===i?'on':''" class="pointer" :index="i">[m
[32m+[m									[32m<li v-for="(session,i) in reverseSessions" v-if="session.status==2" @click="changeSession(sessions.length-i-1)" :class="current===sessions.length-i-1?'on':''" class="pointer" :index="sessions.length-i-1">[m
 										<span class="icon">[m
 											<template v-if="session.head"><img :src="session.head" /></template>[m
 											<template v-else>{{session.session_id.slice(-2)}}</template>[m
[36m@@ -43,7 +43,7 @@[m
 											<p class="font14 opcity5" :title="session.tell.length>0?(session.tell[session.tell.length-1].question||session.tell[session.tell.length-1].answer):''"[m
 												v-html="session.tell_no_img.length>0?(session.tell_no_img[session.tell_no_img.length-1].question||session.tell_no_img[session.tell_no_img.length-1].answer):''">[m
 											</p>[m
[31m-											<span class="pull-right" v-show="session.news.toString().slice(0,1)>0 && current!=i">{{session.news}}</span>[m
[32m+[m											[32m<span class="pull-right" v-show="session.news.toString().slice(0,1)>0 && current!=sessions.length-i-1">{{session.news}}</span>[m
 										</div>[m
 									</li>[m
 								</ul>[m

[33mcommit 9fd7f7bb573c67a30dbae91b7de94aad93f2cb61[m
Author: lijianhui <jianhuili@webot.co>
Date:   Wed Sep 27 13:36:36 2017 +0800

    当前会话列表映射维护（删除新增会话时）

[1mdiff --git a/dist.zip b/dist.zip[m
[1mindex b91ec00..66d9a35 100644[m
Binary files a/dist.zip and b/dist.zip differ
[1mdiff --git a/src/page/servicer/main.vue b/src/page/servicer/main.vue[m
[1mindex 2ba49c7..01c0456 100644[m
[1m--- a/src/page/servicer/main.vue[m
[1m+++ b/src/page/servicer/main.vue[m
[36m@@ -72,6 +72,7 @@[m
 			...mapGetters([[m
 				'getMode'[m
 			]),[m
[32m+[m[41m			[m
 		},[m
 		methods:{[m
 			...mapActions({[m
[36m@@ -104,10 +105,25 @@[m
 							status:val.status,[m
 							msg_ids:[],[m
 						};[m
[32m+[m						[32mv.ids = v.生成会话索引(data.list);[m
 					})[m
 					v.sessions=data.list; [m
 				});[m
 			},[m
[32m+[m			[32m生成会话索引(sessions,old_ids={}){[m
[32m+[m				[32mlet ids = {};[m
[32m+[m				[32msessions.forEach((val,i)=>{[m
[32m+[m					[32mids[val.session_id]={[m
[32m+[m						[32mindex:i,[m
[32m+[m						[32mstatus:val.status,[m
[32m+[m						[32mmsg_ids:[],[m
[32m+[m					[32m}[m
[32m+[m					[32mif(old_ids[val.session_id]){[m
[32m+[m						[32mids[val.session_id].msg_ids=old_ids[val.session_id].msg_ids;[m
[32m+[m					[32m}[m
[32m+[m				[32m})[m
[32m+[m				[32mreturn ids;[m
[32m+[m			[32m},[m
 			initSession(session){[m
 				session.question_status = session.question_status?session.question_status:'';[m
 				session.tag1 = session.tag1?session.tag1:'';[m
[36m@@ -167,32 +183,8 @@[m
 		    	let tell_no_img = {[m
 		    		from:data.from,[m
 		    		time:time,[m
[31m-		    	};                                          [m
[31m-		    	switch(data.msg_type){[m
[31m-		    		case 'event':[m
[31m-		    			tell.text = data.text;[m
[31m-		    			tell_no_img.text = data.text;[m
[31m-			    		break;[m
[31m-			    		[m
[31m-			    	case 'text':[m
[31m-			    		tell.text = v.strToEmoj(data.text);[m
[31m-		    			tell_no_img.text = data.text;[m
[31m-			    		break;[m
[31m-			    	[m
[31m-			    	case 'image':[m
[31m-			    		tell.media = data.media;[m
[31m-			    		tell_no_img.text = '[图片]';[m
[31m-			    		break;[m
[31m-			    	case 'file':[m
[31m-			    		tell.media = data.media;[m
[31m-			    		tell_no_img.text = '[文件]';[m
[31m-			    		break;[m
[31m-			    	case 'text_recommend':[m
[31m-			    		tell.msg_type='text';[m
[31m-			    		tell.text = data.text;[m
[31m-		    			tell_no_img.text = '推荐问题';[m
[31m-			    		break;[m
[31m-		    	}[m
[32m+[m		[41m    [m	[32m};[m[41m [m
[32m+[m		[41m    [m	[32mv.转化聊天数据(data,tell,tell_no_img);[m
 		    	let now = v.$api.dateFormat('yyyy-MM-dd hh:mm:ss');[m
 	       		let news = {[m
 	       			session_id:data.session_id,[m
[36m@@ -224,6 +216,10 @@[m
 				let v =this;                         [m
 				//判断是否是多次接受同一信息[m
 				if(v.ids[data.session_id].msg_ids.indexOf(data.msg_id)!=-1) return;[m
[32m+[m				[32mif(v.sessions[v.ids[data.session_id].index].session_id !== data.session_id){[m
[32m+[m					[32mconsole.error('会话索引列表出 错！，重新生成索引中··',session_id,v.ids[data.session_id].index)[m
[32m+[m					[32mv.ids=v.生成会话索引(v.sessions,v.ids);[m
[32m+[m				[32m}[m
 				v.ids[data.session_id].msg_ids.push(data.msg_id);[m
 				let time = v.$api.dateFormat('yyyy-MM-dd hh:mm:ss',Number(data.timestamp*1000)); [m
 		    	let tell = {[m
[36m@@ -235,26 +231,7 @@[m
 		    		from:data.from,[m
 		    		time:time,[m
 		    	};                                          [m
[31m-		    	switch(data.msg_type){[m
[31m-		    		case 'event':[m
[31m-		    			tell.text = data.text;[m
[31m-		    			tell_no_img.text = data.text;[m
[31m-			    		break;[m
[31m-			    		[m
[31m-			    	case 'text':[m
[31m-			    		tell.text = data.text;   [m
[31m-		    			tell_no_img.text = data.text.replace(statics.emoj.emoj_regex,(code)=>{return this.codeTo中文(code);});[m
[31m-			    		break;[m
[31m-			    	[m
[31m-			    	case 'image':[m
[31m-			    		tell.media = data.media;[m
[31m-			    		tell_no_img.text = '[图片]';[m
[31m-			    		break;[m
[31m-			    	case 'file':[m
[31m-			    		tell.media = data.media;[m
[31m-			    		tell_no_img.text = '[文件]';[m
[31m-			    		break;[m
[31m-		    	}[m
[32m+[m		[41m    [m	[32mv.转化聊天数据(data,tell,tell_no_img);[m
 		    	if(v.ids[data.session_id].status==2){[m
 		    		v.sessions[v.ids[data.session_id].index].status=1;[m
        				v.ids[data.session_id].status=1;[m
[36m@@ -285,6 +262,33 @@[m
 					}[m
 	       		}[m
 			},[m
[32m+[m			[32m转化聊天数据(data,tell,tell_no_img){[m
[32m+[m				[32mswitch(data.msg_type){[m
[32m+[m		[41m    [m		[32mcase 'event':[m
[32m+[m		[41m    [m			[32mtell.text = data.text;[m
[32m+[m		[41m    [m			[32mtell_no_img.text = data.text;[m
[32m+[m			[41m    [m		[32mbreak;[m
[32m+[m[41m			    		[m
[32m+[m			[41m    [m	[32mcase 'text':[m
[32m+[m			[41m    [m		[32mtell.text = data.text;[m[41m   [m
[32m+[m		[41m    [m			[32mtell_no_img.text = data.text.replace(statics.emoj.emoj_regex,(code)=>{return this.codeTo中文(code);});[m
[32m+[m			[41m    [m		[32mbreak;[m
[32m+[m[41m			    	[m
[32m+[m			[41m    [m	[32mcase 'image':[m
[32m+[m			[41m    [m		[32mtell.media = data.media;[m
[32m+[m			[41m    [m		[32mtell_no_img.text = '[图片]';[m
[32m+[m			[41m    [m		[32mbreak;[m
[32m+[m			[41m    [m	[32mcase 'file':[m
[32m+[m			[41m    [m		[32mtell.media = data.media;[m
[32m+[m			[41m    [m		[32mtell_no_img.text = '[文件]';[m
[32m+[m			[41m    [m		[32mbreak;[m
[32m+[m			[41m    [m	[32mcase 'text_recommend':[m
[32m+[m			[41m    [m		[32mtell.msg_type='text';[m
[32m+[m			[41m    [m		[32mtell.text = data.text;[m
[32m+[m		[41m    [m			[32mtell_no_img.text = '推荐问题';[m
[32m+[m			[41m    [m		[32mbreak;[m
[32m+[m		[41m    [m	[32m}[m
[32m+[m			[32m},[m
 			//必须提供session_id[m
 			激活会话(s){[m
 				let v = this;[m
[36m@@ -299,16 +303,11 @@[m
 								v.sessions[v.ids[s.session_id].index].historys=[];[m
 								v.激活后数据的变化(v.sessions[v.current]);[m
 							}else{[m
[31m-								v.ids[s.session_id] = {[m
[31m-									index:0,[m
[31m-									status:1,[m
[31m-									msg_ids:[],[m
[31m-								}[m
 								let ss = v.$api.deepCopy(s);[m
 								v.initSession(ss);[m
[31m-								v.sessions.unshift(ss); [m
[31m-								v.current=0;[m
[31m-								v.getSessionDetail(0);[m
[32m+[m								[32mv.新增会话(s)(ss);[m[41m [m
[32m+[m								[32mv.current=v.sessions.length-1;[m
[32m+[m								[32mv.getSessionDetail(v.current);[m
 							}[m
 							v.getLogss(v.current);  [m
 							resolve(v.sessions[v.ids[s.session_id].index])[m
[36m@@ -341,8 +340,24 @@[m
 			删除会话(s,index=undefined){[m
 				let v = this;[m
 				if(index==undefined) index = v.ids[s.session_id].index;[m
[31m-				delete v.ids[s.session_id];[m
 				v.sessions.splice(index,1);[m
[32m+[m				[32mv.ids = v.生成会话索引(v.sessions,v.ids);[m
[32m+[m			[32m},[m
[32m+[m			[32m新增会话(s){[m
[32m+[m				[32mlet v = this;[m
[32m+[m				[32mv.sessions.push(s);[m
[32m+[m				[32mif(v.ids[s.session_id]){[m
[32m+[m					[32mlet i = v.ids[s.session_id].index;[m
[32m+[m					[32mif(s.session_id!==v.sessions[i].session_id){[m
[32m+[m						[32mv.ids=v.生成会话索引(v.sessions,v.ids);[m
[32m+[m					[32m}[m
[32m+[m				[32m}else{[m
[32m+[m					[32mv.ids[s.session_id]={[m
[32m+[m						[32mindex:v.sessions.length-1,[m
[32m+[m						[32mstatus:s.status,[m
[32m+[m						[32mmsg_ids:[],[m
[32m+[m					[32m}[m
[32m+[m				[32m}[m
 			},[m
 			getSessionDetail(i){[m
 				let v= this;[m
[1mdiff --git a/src/page/servicer/session.vue b/src/page/servicer/session.vue[m
[1mindex 329ec1e..b88e18b 100644[m
[1m--- a/src/page/servicer/session.vue[m
[1m+++ b/src/page/servicer/session.vue[m
[36m@@ -6,7 +6,7 @@[m
 					  	<el-collapse-item :title="'会话中('+getStatusNum(1)+')'" name="1" class="font14">[m
 						    <bar :wrapper="'wrapper'">[m
 								<ul>[m
[31m-									<li v-for="(session,i) in sessions" v-if="session.status==1" @click="changeSession(i)" :class="current===i?'on':''" class="pointer" :index="i">[m
[32m+[m									[32m<li v-for="(session,i) in reverseSessions" v-if="session.status==1" @click="changeSession(i)" :class="current===i?'on':''" class="pointer" :index="i">[m
 										<span class="icon">[m
 											<template v-if="session.head && session.head!==''"><img :src="session.head" /></template>[m
 											<template v-else>{{session.session_id.slice(-2)}}</template>[m
[36m@@ -29,7 +29,7 @@[m
 					  	<el-collapse-item :title="'已结束('+getStatusNum(2)+')'" name="2">[m
 						    <bar :wrapper="'wrapper'">[m
 								<ul>[m
[31m-									<li v-for="(session,i) in sessions" v-if="session.status==2" @click="changeSession(i)" :class="current===i?'on':''" class="pointer" :index="i">[m
[32m+[m									[32m<li v-for="(session,i) in reverseSessions" v-if="session.status==2" @click="changeSession(i)" :class="current===i?'on':''" class="pointer" :index="i">[m
 										<span class="icon">[m
 											<template v-if="session.head"><img :src="session.head" /></template>[m
 											<template v-else>{{session.session_id.slice(-2)}}</template>[m
[36m@@ -239,9 +239,10 @@[m
       		[m
 		},[m
 		computed:{[m
[31m-			filterAnswers(){[m
[31m-				[m
[31m-			},[m
[32m+[m			[32mreverseSessions(){[m
[32m+[m				[32mlet s = this.$api.deepCopy(this.sessions);[m
[32m+[m				[32mreturn s.reverse();[m
[32m+[m			[32m}[m
 		},[m
 		methods:{[m
 			getStatusNum(status){[m

[33mcommit 704e1383813faab3c8561cd7096ed5c57d30ca7d[m
Author: lijianhui <jianhuili@webot.co>
Date:   Tue Sep 26 20:16:34 2017 +0800

    输入框表情被隐藏问题+打包

[1mdiff --git a/dist.zip b/dist.zip[m
[1mindex 77f93ac..b91ec00 100644[m
Binary files a/dist.zip and b/dist.zip differ

[33mcommit 59fea1713df77884fa5a396087664ad5dfa77ce9[m
Author: lijianhui <jianhuili@webot.co>
Date:   Tue Sep 26 20:14:18 2017 +0800

    输入框表情被隐藏问题

[1mdiff --git a/src/page/servicer/session.vue b/src/page/servicer/session.vue[m
[1mindex 19dc2f4..329ec1e 100644[m
[1m--- a/src/page/servicer/session.vue[m
[1m+++ b/src/page/servicer/session.vue[m
[36m@@ -76,10 +76,11 @@[m
 							<span v-if="e.uri==undefined">{{e.txt}}</span>[m
 						</b>[m
 					</div>[m
[32m+[m					[32m<div class="write_wrap" contenteditable='false'>[m
[32m+[m						[32m<div @keydown="sayKeyDown"  @input="inputChange" @paste="pasteHandler" ref='write' id="write" class="write" contenteditable="true" placeholder="小提示：在输入框内按下“Ctrl+Enter”,可以换行输入内容"> </div>[m
[32m+[m						[32m<!--<textarea v-if="input.type=='txt'" v-model="input.text" @keydown="sayKeyDown" @input="inputChange" @focus="say.focus=true" @blur="say.focus=false" ref='write' class="write" multiple="multiple" placeholder="小提示：在输入框内按下“Ctrl+Enter”,可以换行输入内容"></textarea>-->[m
[32m+[m					[32m</div>[m
 					[m
[31m-					<div @keydown="sayKeyDown"  @input="inputChange" @paste="()=>{if(input.type=='txt'){pasteHandler();}}" ref='write' id="write" class="write" contenteditable="true" placeholder="小提示：在输入框内按下“Ctrl+Enter”,可以换行输入内容"> </div>[m
[31m-					<!--<textarea v-if="input.type=='txt'" v-model="input.text" @keydown="sayKeyDown" @input="inputChange" @focus="say.focus=true" @blur="say.focus=false" ref='write' class="write" multiple="multiple" placeholder="小提示：在输入框内按下“Ctrl+Enter”,可以换行输入内容"></textarea>-->[m
[31m-						[m
 					</bar>[m
 					<div class="hint" v-if="answer.show || 快捷回复.show" ref="hint">[m
 						<bar :wrapper="'wrapper'" :scrollTop="answer" v-show="answer.show">[m
[36m@@ -653,7 +654,7 @@[m
 			// 	}[m
 			// 	return false;[m
 			// },[m
[31m-			pasteHandler(e){[m
[32m+[m			[32mpasteHandler(e){[m[41m   [m
 				let v= this;[m
 				let _this = v.$refs.write;[m
 		        e.preventDefault();[m
[36m@@ -840,14 +841,14 @@[m
 	[m
 	#session .section .say .emoj {position:absolute; left:8px; bottom:265px; width:calc(100% - 17px); font-size:0; background:#fff;}[m
 	#session .section .say .emoj b {display:inline-block; vertical-align:top; width:30px; height:30px; line-height:30px; text-align:center; border:0.5px solid #eee;}[m
[31m-	#session .section .say {height:265px;background:#f7fbff; position:relative; overflow-x:hidden;}[m
[32m+[m	[32m#session .section .say {height:265px;background:#f7fbff; position:relative; }[m
 	#session .section .say button {position:absolute; bottom:20px; right:20px; background:rgba(0,0,0,0);}[m
 	#session .section .say.focus {background:#fff;}[m
 	#session .section .say.kfState0:after {content:''; display:block; position:absolute; width:100%; height:100%; top:0; left:0; background:rgba(255,255,255,0.3);}[m
 	#session .section .say.kfState0:hover {cursor:not-allowed;}[m
 	#session .section .say .hint .wrapper {max-height:160px; width:100%;}[m
[31m-	[m
[31m-	#session .section .say .write {width:calc(100% + 42px); height:140px; font-size:14px; outline:none; border:none; background:rgba(0,0,0,0); overflow-y:auto ; resize: none; padding:0 60px 0 20px;}[m
[32m+[m	[32m#session .section .say .write_wrap {max-width:100%;overflow-x:hidden;}[m
[32m+[m	[32m#session .section .say .write {width:calc(100% + 42px); height:140px; font-size:14px; outline:none; border:none; background:rgba(0,0,0,0); overflow-y:auto ; resize: none; padding:0 60px 0 20px; word-break: break-all;}[m
 	#session .section .say .write:empty:before{content: attr(placeholder);color:#bbb;}[m
 	#session .section .say .write::placeholder { color:#d2dff0;}[m
 	#session .section .say .write:focus{content:none;}[m

[33mcommit ef3a717a3e892bc23cdc6b0600c2d905ecaac9b3[m
Author: lijianhui <jianhuili@webot.co>
Date:   Wed Sep 20 18:30:38 2017 +0800

    转接bug修复

[1mdiff --git a/dist.zip b/dist.zip[m
[1mindex cb6bd38..77f93ac 100644[m
Binary files a/dist.zip and b/dist.zip differ
[1mdiff --git a/src/page/servicer/main.vue b/src/page/servicer/main.vue[m
[1mindex 10b5cc7..2ba49c7 100644[m
[1m--- a/src/page/servicer/main.vue[m
[1m+++ b/src/page/servicer/main.vue[m
[36m@@ -338,9 +338,9 @@[m
 					})[m
 				})[m
 			},[m
[31m-			删除会话(s,index){[m
[32m+[m			[32m删除会话(s,index=undefined){[m
 				let v = this;[m
[31m-				if(!index) index = v.ids[s.session_id].index;[m
[32m+[m				[32mif(index==undefined) index = v.ids[s.session_id].index;[m
 				delete v.ids[s.session_id];[m
 				v.sessions.splice(index,1);[m
 			},[m

[33mcommit adaa285e6681274b6c8c15d47c8958c7a6850419[m
Author: lijianhui <jianhuili@webot.co>
Date:   Wed Sep 20 18:08:35 2017 +0800

    zip

[1mdiff --git a/dist.zip b/dist.zip[m
[1mindex 7c50173..cb6bd38 100644[m
Binary files a/dist.zip and b/dist.zip differ
[1mdiff --git a/src/page/index.vue b/src/page/index.vue[m
[1mindex 4bbc9f7..7aa5ed3 100644[m
[1m--- a/src/page/index.vue[m
[1m+++ b/src/page/index.vue[m
[36m@@ -96,7 +96,7 @@[m
 						<tbody>[m
 							<tr v-for="kf in kfs" v-if="kf.权限=='超级管理员'">[m
 								<td style="color:#ff9c00;">[m
[31m-									<img v-if="kf.权限=='超级管理员'" src="../assets/img/super_icon.png" />[m
[32m+[m									[32m<img src="../assets/img/super_icon.png" />[m
 									&nbsp;{{kf.姓名}}[m
 								</td>[m
 								<td><i class="o" :class="kf.在线状态=='在线'?'online':''"></i>&nbsp;{{kf.在线状态}}</td>[m

[33mcommit d4f556fe37f02490201fb46b39c3859ebc3d17aa[m
Author: lijianhui <jianhuili@webot.co>
Date:   Wed Sep 20 17:57:46 2017 +0800

    zip

[1mdiff --git a/dabao.sh b/dabao.sh[m
[1mnew file mode 100644[m
[1mindex 0000000..ff38fca[m
[1m--- /dev/null[m
[1m+++ b/dabao.sh[m
[36m@@ -0,0 +1,2 @@[m
[32m+[m[32mnpm build[m
[32m+[m[32mzip dist/ dist.zip[m

[33mcommit 660a132aa956a68706bb8d05ff176530390ebc01[m
Merge: aa2aa6e 218777e
Author: lijianhui <jianhuili@webot.co>
Date:   Wed Sep 20 17:51:30 2017 +0800

    Merge branch 'v2.0' of http://192.168.3.101/jianglinlin/data-admin-ui into v2.0

[33mcommit aa2aa6e0d22c908282e75ed65e3fd8eb3b5cfe79[m
Author: lijianhui <jianhuili@webot.co>
Date:   Wed Sep 20 17:51:09 2017 +0800

    zip压缩

[1mdiff --git a/src/page/index.vue b/src/page/index.vue[m
[1mindex e6119ec..4bbc9f7 100644[m
[1m--- a/src/page/index.vue[m
[1m+++ b/src/page/index.vue[m
[36m@@ -97,8 +97,6 @@[m
 							<tr v-for="kf in kfs" v-if="kf.权限=='超级管理员'">[m
 								<td style="color:#ff9c00;">[m
 									<img v-if="kf.权限=='超级管理员'" src="../assets/img/super_icon.png" />[m
[31m-									<img v-if="kf.权限=='管理员'" src="../assets/img/admin_icon.png" />[m
[31m-									<img v-if="kf.权限=='普通用户'" src="../assets/img/user2_icon.png" />[m
 									&nbsp;{{kf.姓名}}[m
 								</td>[m
 								<td><i class="o" :class="kf.在线状态=='在线'?'online':''"></i>&nbsp;{{kf.在线状态}}</td>[m

[33mcommit 218777e52c14e2aed90709c7900629195425e192[m
Author: xuwei <weixu@webot.co>
Date:   Wed Sep 20 17:47:31 2017 +0800

    打包2

[1mdiff --git a/dist.zip b/dist.zip[m
[1mindex 9790e3c..7c50173 100644[m
Binary files a/dist.zip and b/dist.zip differ

[33mcommit 78b95b52f7ecde58acc635d70726b2c9cd34f63d[m
Author: lijianhui <jianhuili@webot.co>
Date:   Wed Sep 20 17:30:35 2017 +0800

    打包

[1mdiff --git a/src/page/servicer/session.vue b/src/page/servicer/session.vue[m
[1mindex 9da7b95..19dc2f4 100644[m
[1m--- a/src/page/servicer/session.vue[m
[1m+++ b/src/page/servicer/session.vue[m
[36m@@ -357,12 +357,12 @@[m
 					v.turn.show=true;[m
 				})[m
 			},[m
[31m-			close转接(){[m
[32m+[m			[32m转接成功(){[m
 				let v = this;[m
 				v.turn.show=false;[m
 				v.turn.user_id='';[m
 				v.turn.group_id='';[m
[31m-				v.删除会话(v.sessions[v.current],v.curremnt);[m
[32m+[m				[32mv.删除会话(v.sessions[v.current],v.current);[m
 				v.重新计算显示会话();[m
 			},[m
 			转接ed(){                         [m
[36m@@ -381,7 +381,7 @@[m
 				}[m
 				v.$api.ajax(v.$uri.session.转接客服,'post',send)[m
 				.then(data=>{[m
[31m-					v.close转接();[m
[32m+[m					[32mv.转接成功();[m
 				})[m
 			},[m
 			add_emoj(e){[m

[33mcommit f2a6346d796dac6dd81ab62c77e1669cae676f09[m
Merge: 37f1d30 1a609d7
Author: xuwei <weixu@webot.co>
Date:   Wed Sep 20 16:43:37 2017 +0800

    Merge branch 'v2.0' of 192.168.3.101:jianglinlin/data-admin-ui into v2.0

[33mcommit 1a609d7fad5b77df30f49041af2946766afa9482[m
Author: lijianhui <jianhuili@webot.co>
Date:   Wed Sep 20 16:41:42 2017 +0800

    添加图片

[1mdiff --git a/src/assets/img/admin_icon.png b/src/assets/img/admin_icon.png[m
[1mnew file mode 100644[m
[1mindex 0000000..206f68e[m
Binary files /dev/null and b/src/assets/img/admin_icon.png differ
[1mdiff --git a/src/assets/img/super_icon.png b/src/assets/img/super_icon.png[m
[1mnew file mode 100644[m
[1mindex 0000000..5dec4db[m
Binary files /dev/null and b/src/assets/img/super_icon.png differ
[1mdiff --git a/src/assets/img/user2_icon.png b/src/assets/img/user2_icon.png[m
[1mnew file mode 100644[m
[1mindex 0000000..2858a79[m
Binary files /dev/null and b/src/assets/img/user2_icon.png differ
[1mdiff --git a/src/page/mixin/.图表.js.swp b/src/page/mixin/.图表.js.swp[m
[1mnew file mode 100644[m
[1mindex 0000000..2077a72[m
Binary files /dev/null and b/src/page/mixin/.图表.js.swp differ

[33mcommit 37f1d30d16e63c9b5cc4e6ce3db0e78a974055b8[m
Merge: 8b904b0 c8f79b4
Author: xuwei <weixu@webot.co>
Date:   Wed Sep 20 16:39:40 2017 +0800

    Merge branch 'v2.0' of 192.168.3.101:jianglinlin/data-admin-ui into v2.0

[33mcommit c8f79b474d46ca7d23fef10f9ca0bba3ce932014[m
Author: lijianhui <jianhuili@webot.co>
Date:   Wed Sep 20 16:36:48 2017 +0800

    部分bug

[1mdiff --git a/src/App.vue b/src/App.vue[m
[1mindex 83b08d8..7388ef7 100644[m
[1m--- a/src/App.vue[m
[1m+++ b/src/App.vue[m
[36m@@ -115,7 +115,7 @@[m [mexport default {[m
 <style>[m
 	#wrap {display:flex; width:100%; min-width: 1200px; height:100%; font-size:0; position:relative;}[m
 	#nav,#content { vertical-align:top; font-size:12px;}[m
[31m-	#nav {height:100%; background:#fff;flex-shrink:1; box-shadow:1px 0px 5px #ccc; position:relative; z-index:1;}[m
[32m+[m	[32m#nav {height:100%; background:#fff;flex-shrink:1; box-shadow:1px 0px 5px #ccc; position:relative; z-index:100;}[m
 	#content {    [m
 		flex: 1;[m
     [m
[36m@@ -144,7 +144,7 @@[m [mexport default {[m
   	#content { width:1000px;}[m
   }*/[m
   [m
[31m-  #content .header {height:70px; background:#fff;text-align:right;box-shadow:1px 0px 5px #ccc; position:relative; z-index:10;}[m
[32m+[m[32m  #content .header {height:70px; text-align:right;box-shadow:1px 0px 5px #ccc; position:relative; z-index:10;}[m
   #content .header .username {display:inline-block;vertical-align: middle; width:70px;overflow:hidden;word-break:keep-all;white-space:nowrap;text-overflow:ellipsis;}[m
   #content .header .username + span {vertical-align: middle;}[m
   #content .header .select_model {display:inline-block; position:relative; top:25px; right:20px;;}[m
[1mdiff --git a/src/assets/css/base.css b/src/assets/css/base.css[m
[1mindex e0fcb62..832e678 100644[m
[1m--- a/src/assets/css/base.css[m
[1m+++ b/src/assets/css/base.css[m
[36m@@ -36,6 +36,7 @@[m [mlabel {font-weight:normal;}[m
 .font20 {font-size:20px;;}[m
 .font50 {font-size:50px;;}[m
 [m
[32m+[m[32m.opcity2{opacity:0.2;}[m
 .opcity5{opacity:0.5;}[m
 .opcity9{opacity:0.9;}[m
 [m
[1mdiff --git a/src/page/index.vue b/src/page/index.vue[m
[1mindex 8c09318..e6119ec 100644[m
[1m--- a/src/page/index.vue[m
[1m+++ b/src/page/index.vue[m
[36m@@ -94,8 +94,39 @@[m
 							<th>累计在线时间</th>[m
 						</tr>[m
 						<tbody>[m
[31m-							<tr v-for="kf in kfs">[m
[31m-								<td><i class="fa fa-user"></i>&nbsp;{{kf.姓名}}</td>[m
[32m+[m							[32m<tr v-for="kf in kfs" v-if="kf.权限=='超级管理员'">[m
[32m+[m								[32m<td style="color:#ff9c00;">[m
[32m+[m									[32m<img v-if="kf.权限=='超级管理员'" src="../assets/img/super_icon.png" />[m
[32m+[m									[32m<img v-if="kf.权限=='管理员'" src="../assets/img/admin_icon.png" />[m
[32m+[m									[32m<img v-if="kf.权限=='普通用户'" src="../assets/img/user2_icon.png" />[m
[32m+[m									[32m&nbsp;{{kf.姓名}}[m
[32m+[m								[32m</td>[m
[32m+[m								[32m<td><i class="o" :class="kf.在线状态=='在线'?'online':''"></i>&nbsp;{{kf.在线状态}}</td>[m
[32m+[m								[32m<td>{{kf.当前接待量}}</td>[m
[32m+[m								[32m<td>--</td>[m
[32m+[m								[32m<td>--</td>[m
[32m+[m								[32m<td>--</td>[m
[32m+[m								[32m<td>--</td>[m
[32m+[m								[32m<td>--</td>[m
[32m+[m							[32m</tr>[m
[32m+[m							[32m<tr v-for="kf in kfs" v-if="kf.权限=='管理员'">[m
[32m+[m								[32m<td>[m
[32m+[m									[32m<img v-if="kf.权限=='管理员'" src="../assets/img/admin_icon.png" />[m
[32m+[m									[32m&nbsp;{{kf.姓名}}[m
[32m+[m								[32m</td>[m
[32m+[m								[32m<td><i class="o" :class="kf.在线状态=='在线'?'online':''"></i>&nbsp;{{kf.在线状态}}</td>[m
[32m+[m								[32m<td>{{kf.当前接待量}}</td>[m
[32m+[m								[32m<td>--</td>[m
[32m+[m								[32m<td>--</td>[m
[32m+[m								[32m<td>--</td>[m
[32m+[m								[32m<td>--</td>[m
[32m+[m								[32m<td>--</td>[m
[32m+[m							[32m</tr>[m
[32m+[m							[32m<tr v-for="kf in kfs" v-if="kf.权限=='普通用户'">[m
[32m+[m								[32m<td>[m
[32m+[m									[32m<img src="../assets/img/user2_icon.png" />[m
[32m+[m									[32m&nbsp;{{kf.姓名}}[m
[32m+[m								[32m</td>[m
 								<td><i class="o" :class="kf.在线状态=='在线'?'online':''"></i>&nbsp;{{kf.在线状态}}</td>[m
 								<td>{{kf.当前接待量}}</td>[m
 								<td>--</td>[m
[36m@@ -236,14 +267,15 @@[m
 				        data:['总会话量','机器人会话量','人工会话量'],[m
 				    },[m
 				    grid: {[m
[31m-				        left: '3%',[m
[31m-				        right: '4%',[m
[31m-				        bottom: '10%',[m
[31m-				        top:'8%',[m
[32m+[m				[32m        left: '0%',[m
[32m+[m				[32m        right: '0%',[m
[32m+[m				[32m        bottom: '14%',[m
[32m+[m				[32m        top:'3%',[m
 				        containLabel: true[m
 				    },[m
 				    toolbox: {[m
 				        show: true,[m
[32m+[m				[32m        bottom:0,[m
 						feature: {[m
 							magicType: {type: ['line', 'bar']},[m
 						},[m
[36m@@ -263,6 +295,9 @@[m
 				        		opacity:0.5,[m
 				        	}[m
 				        },[m
[32m+[m				[32m        axisLabel:{[m
[32m+[m				[41m        [m	[32mcolor:'#000',[m
[32m+[m				[32m        },[m
 				        data: [][m
 				    },[m
 				    yAxis:{[m
[36m@@ -277,6 +312,9 @@[m
 				        		opacity:0.5,[m
 				        	}[m
 				        },[m
[32m+[m				[32m        axisLabel:{[m
[32m+[m				[41m        [m	[32mcolor:'#000',[m
[32m+[m				[32m        },[m
 				    },[m
 				    series: [[m
 				        {[m
[36m@@ -510,7 +548,10 @@[m
 	}[m
 </script>[m
 <style lang="scss">[m
[32m+[m	[32m$color_1:#eee;[m
[32m+[m	[32m$color_2:#efefef;[m
 	.home {[m
[32m+[m		[32mbackground:#f6f8f9;[m
 		.headers {[m
 			height: 80px;[m
 			.welcome  {[m
[36m@@ -522,26 +563,34 @@[m
 		.main{[m
 			padding:20px 40px;[m
 			.box {[m
[31m-				padding:20px; [m
[31m-				margin:15px 0; background:#fff;  @extend .boxShadow_1_1_3_3_f3;[m
[31m-				h2{line-height:40px;border-bottom:1px solid #eee; margin-bottom:10px;}[m
[32m+[m				[32mpadding:10px 40px 20px;[m[41m [m
[32m+[m				[32mmargin:10px 0; background:#fff;  @extend .boxShadow_1_1_3_3_f3;[m
[32m+[m				[32mh2{font-size:17px; font-weight:bold; line-height:50px;border-bottom:1px solid $color_1; margin-bottom:20px;}[m
 				.box_info {[m
 					display: inline-block;[m
[31m-					width: 250px;[m
[32m+[m					[32mwidth:100%;[m
 					padding: 20px 0 0;[m
[31m-					margin: 10px;[m
[32m+[m					[32mmargin: 0px;[m
 					background: #fff;[m
[31m-					box-shadow: 1px 1px 2px 2px #f3f3f3;[m
[32m+[m					[32mborder:1px solid #cfcfcf;[m
[32m+[m					[32mp{background:#f9f9f9;}[m
[32m+[m					[32mdiv {[m
[32m+[m						[32m&:first-child {[m
[32m+[m[41m							[m
[32m+[m							[32mstrong {font-size:40px; line-height:80px;}[m
[32m+[m						[32m}[m
[32m+[m					[32m}[m
 				}[m
 				table {[m
 					width:100%;border:1px solid #e2e2e2;[m
 					tr{[m
[31m-						th {line-height:40px; padding:0 15px;background:#f9f9f9;}[m
[32m+[m						[32mth {font-size:14px;line-height:40px; padding:0 15px;background:#f9f9f9;}[m
 					}[m
 					tbody {[m
 						tr {[m
[31m-							border-top:1px solid #e2e2e2;[m
[31m-							td {padding:0 15px; line-height:40px;}[m
[32m+[m							[32mborder-top:1px solid $color_2;[m
[32m+[m							[32mtd {font-size:13px; padding:0 15px; line-height:40px;}[m
[32m+[m							[32mimg {width:16px;}[m
 						}[m
 					}[m
 					.fa-user {color:#89c997;}[m
[36m@@ -554,11 +603,11 @@[m
 			.resolve-rate {[m
 				margin-left:20px;[m
 				width:calc(25% - 20px);[m
[31m-				h4 {line-height:70px;}[m
[31m-				p {font-size:55px; text-align:center;}[m
[32m+[m				[32mh4 {line-height:70px; font-size:15px;}[m
[32m+[m				[32mp {width:50%; margin:auto;font-size:45px; line-height:80px; text-align:center;}[m
 				.human {[m
 					i {color:#f47171;}[m
[31m-					& + p {color:#f47171;}[m
[32m+[m					[32m& + p {color:#f47171;border-bottom:1px solid $color_2;}[m
 				}[m
 				.robot {[m
 					i {color:#2b94ff;}[m
[36m@@ -567,18 +616,26 @@[m
 			}[m
 		}[m
 	}[m
[31m-	[m
 	.box_info {[m
 		display: inline-block;[m
[31m-		width: 250px;[m
[32m+[m		[32mwidth:100%;[m
 		padding: 20px 0 0;[m
[31m-		margin: 10px;[m
[32m+[m		[32mmargin: 0px;[m
 		background: #fff;[m
[31m-		box-shadow: 1px 1px 5px 3px #f3f3f3;[m
[32m+[m		[32mborder:1px solid #cfcfcf;[m
[32m+[m		[32mp{background:#f9f9f9;}[m
[32m+[m		[32mdiv {[m
[32m+[m			[32m&:first-child {[m
[32m+[m[41m				[m
[32m+[m				[32mstrong {font-size:40px; line-height:80px;}[m
[32m+[m			[32m}[m
[32m+[m		[32m}[m
[32m+[m	[32m}[m
[32m+[m	[32m.box_info {[m
[32m+[m		[32mborder:1px solid #cfcfcf;[m
 	}[m
 	.box_info>div:first-child {[m
 		text-align: center;[m
[31m-		line-height: 60px;[m
 		border-bottom: 1px solid #eee;[m
 	}[m
 	[m
[36m@@ -615,6 +672,6 @@[m
 	}[m
 	[m
 	.boxShadow_1_1_3_3_f3 {[m
[31m-		box-shadow: 1px 1px 3px 3px #f3f3f3;[m
[32m+[m		[32mbox-shadow: 1px 1px 5px 1px rgba(#c3c3c3,0.7);[m
 	}[m
 </style>[m
\ No newline at end of file[m
[1mdiff --git a/src/page/mixin/图表.js b/src/page/mixin/图表.js[m
[1mindex d2dc26a..9ce1904 100644[m
[1m--- a/src/page/mixin/图表.js[m
[1m+++ b/src/page/mixin/图表.js[m
[36m@@ -7,7 +7,7 @@[m [mexport default {[m
 		}[m
 	},[m
   	methods:{[m
[31m-  		fn_mixin计算折线或柱状图的最大值(value){ [m
[32m+[m[41m  [m		[32mfn_mixin计算折线或柱状图的最大值(value){[m
         	if(value.max<5){[m
         		return value.max+5;[m
         	}else{[m
[36m@@ -16,7 +16,8 @@[m [mexport default {[m
         			max /=10;[m
         			digit*=10;[m
         		}[m
[31m-        		return Math.ceil(value.max/digit)*digit;[m
[32m+[m[41m        [m		[32mlet val = Math.ceil(value.max/digit)==9?10:Math.ceil(value.max/digit);[m
[32m+[m[41m        [m		[32mreturn val*digit;[m
         	}[m
         }[m
   	},[m
[1mdiff --git a/src/page/module/primaryNav.vue b/src/page/module/primaryNav.vue[m
[1mindex a179422..63216aa 100644[m
[1m--- a/src/page/module/primaryNav.vue[m
[1m+++ b/src/page/module/primaryNav.vue[m
[36m@@ -115,7 +115,7 @@[m [mexport default {[m
 	#primaryNav .navs li.active {background:#f6f8f9;}[m
 	#primaryNav .navs .hover_show {position:absolute;height:100%; width:5px; top:0; left:0; opacity:0; border-bottom-right-radius:3px;border-top-right-radius:3px;}[m
 	#primaryNav .navs li:hover .hover_show,#primaryNav .navs li.active .hover_show {opacity:1;}[m
[31m-	#primaryNav .glyphicon-transfer {position:absolute;top:0; right:-11px; z-index:50;}[m
[32m+[m	[32m#primaryNav .glyphicon-transfer {position:absolute;top:0; right:-11px; z-index:250;}[m
 	#primaryNav .navName {transition:all ease-in-out .1s;}[m
 	#primaryNav .navs .font0 .navName {font-size:0; }[m
 	#primaryNav .navs .font0 .icon {padding:5px 0;}[m
[1mdiff --git a/src/page/module/subNav.vue b/src/page/module/subNav.vue[m
[1mindex 2ce7cea..b029ce6 100644[m
[1m--- a/src/page/module/subNav.vue[m
[1m+++ b/src/page/module/subNav.vue[m
[36m@@ -40,7 +40,7 @@[m
 	}[m
 </script>[m
 <style>[m
[31m-	#subNav { padding:19px 0 18px; height:70px; min-width:700px; position:absolute; left:0; top:-0px; background: white; z-index:15;}[m
[32m+[m	[32m#subNav { padding:19px 0 18px; height:70px; min-width:700px; position:absolute; left:0; top:-0px; z-index:15;}[m
 	#subNav ul.nav2 {display:inline-block; background: #fff; border-radius:5px; margin:3px 3px 3px 20px; overflow:hidden;}[m
 	#subNav ul.nav2 li a {font-size:20px; color:#2bb3f3; padding:2px 10px; display:inline-block; text-decoration:none;}[m
 	#subNav ul.nav2 li.active a{ color:#fff;  background:#2bb3f3; border-radius:5px;}[m
[1mdiff --git a/src/page/rebotKnowledgeStore/activitySetting.vue b/src/page/rebotKnowledgeStore/activitySetting.vue[m
[1mindex 513ef98..b5ff4ca 100644[m
[1m--- a/src/page/rebotKnowledgeStore/activitySetting.vue[m
[1m+++ b/src/page/rebotKnowledgeStore/activitySetting.vue[m
[36m@@ -72,7 +72,7 @@[m
 					</tbody>[m
 				</table>[m
 			</div>[m
[31m-			<div class="pagination_wrap">[m
[32m+[m			[32m<div class="pagination_wrap" v-if="total>0">[m
 				<pagination :page="page" :total="total" :searchString='prev_page.q' v-on:pageTurn="pageTurn"></pagination>[m
 			</div>[m
 		</div>[m
[36m@@ -335,8 +335,9 @@[m
 						if(typeof data[i].advanced_options == 'string' &&  data[i].advanced_options!=='')[m
 							data[i].advanced_options = JSON.parse(data[i].advanced_options)[m
 					}[m
[31m-					v.list = data;[m
[31m-					v.prev_page = page;[m
[32m+[m					[32mv.list = data.list;[m
[32m+[m					[32mv.total = data.total;[m
[32m+[m					[32mv.prev_page.q = page.q;[m
 				})[m
 			},[m
 			getTags(){[m
[36m@@ -616,6 +617,8 @@[m
 					this.editQuestion.advanced_options.end_switch='';[m
 					this.editQuestion.advanced_options.keyword_switch='';[m
 					this.editQuestion.advanced_options.warning_switch='';[m
[32m+[m				[32m}else{[m
[32m+[m					[32mthis.editQuestion.activity=this.page.activity;[m
 				}[m
 			},[m
 		},[m
[1mdiff --git a/src/page/rebotKnowledgeStore/knowledgeStore.vue b/src/page/rebotKnowledgeStore/knowledgeStore.vue[m
[1mindex f3018c6..f98333c 100644[m
[1m--- a/src/page/rebotKnowledgeStore/knowledgeStore.vue[m
[1m+++ b/src/page/rebotKnowledgeStore/knowledgeStore.vue[m
[36m@@ -112,7 +112,7 @@[m
 						<!--<span class="col-sm-1 red" v-show="question.question.trim()==''">必填</span>-->[m
 					</div>[m
 					<div class="form-group">[m
[31m-						<label class="col-sm-2">分类</label>[m
[32m+[m						[32m<label class="col-sm-2">分类<span class="red">&emsp;*</span></label>[m
 						<div class="col-sm-10 row">[m
 							<span class="col-sm-5">[m
 								<select v-model="question.tag1" class="form-control">[m
[36m@@ -171,7 +171,7 @@[m
 						</div>[m
 					</div>[m
 					<div class="form-group">[m
[31m-						<label class="col-sm-2">分类</label>[m
[32m+[m						[32m<label class="col-sm-2">分类<span class="red">&emsp;*</span></label>[m
 						<div class="col-sm-10 row">[m
 							<span class="col-sm-5">[m
 								<select v-model="question.tag1" class="form-control">[m
[36m@@ -256,7 +256,7 @@[m
 			    <button type="button" class="btn btn-default" @click="clearAll(),show_modal_upload = false">关闭</button>[m
 			</div>[m
 		</modal>[m
[31m-		<loading :show.sync="show_loading>0"></loading>[m
[32m+[m[41m		[m
 	</div>[m
 </template>[m
 <script>[m
[36m@@ -271,7 +271,6 @@[m [mexport default {[m
 	mixins: [handler],[m
   data () {[m
     return {[m
[31m-    	show_loading:0,[m
       	show_modal_info:false,[m
       	show_modal_info2:false,[m
       	show_modal_upload:false,[m
[1mdiff --git a/src/page/report/pandect.vue b/src/page/report/pandect.vue[m
[1mindex 3036b06..fd1664b 100644[m
[1m--- a/src/page/report/pandect.vue[m
[1m+++ b/src/page/report/pandect.vue[m
[36m@@ -1,57 +1,53 @@[m
 <template>[m
[31m-	<div id="pandect_data" class="report">[m
[31m-		<div class="search_wrap"><br />[m
[31m-			<div class="date text-right" >[m
[31m-				[m
[31m-			</div>[m
[31m-		</div>[m
[32m+[m	[32m<div id="pandect_data" class="report"><br />[m
 		<h1 class="col-md-12">在线服务数据 <el-date-picker class="pull-right search_time" v-model="search.date" :picker-options="pickerOptions" :clearable="false" type="daterange" format="yyyy年MM月dd日" placeholder="选择日期"> </el-date-picker></h1>[m
[32m+[m		[32m<br />[m
 		<div class="resolve part clearfix">[m
[31m-			<div class="col-md-3 col-lg-3 text-center">[m
[32m+[m			[32m<div class="col-md-3 col-lg-3 text-center ">[m
 				<div class="box_info">[m
 					<div class="total">[m
[31m-						<h4>总会话量</h4>[m
[32m+[m						[32m<h3>总会话量</h3>[m
 						<strong>{{oneData['总会话量']}}</strong>[m
 					</div>[m
 					<div class="rate">[m
[31m-						<p>机器人解决量：{{oneData['机器人解决量']}}</p>[m
[31m-						<p>机器人解决率：{{oneData['机器人解决率']}}%</p>[m
[32m+[m						[32m<p><span style="width:60%;">机器人解决量：</span>{{oneData['机器人解决量']}}</p>[m
[32m+[m						[32m<p><span style="width:60%;">机器人解决率：</span>{{oneData['机器人解决率']}}%</p>[m
 					</div>[m
 				</div>[m
 			</div>[m
 			<div class="col-md-3  col-lg-3 text-center">[m
 				<div class="box_info">[m
 					<div class="total">[m
[31m-						<h4>总消息量</h4>[m
[32m+[m						[32m<h3>总消息量</h3>[m
 						<strong>{{oneData['总对话数']}}</strong>[m
 					</div>[m
 					<div class="rate">[m
[31m-						<p>&emsp;&ensp;问答比：{{(oneData['客户问题数']/(oneData['客服回答数']||1)).toFixed(2)}}%</p>[m
[31m-						<p>30s应答率：{{oneData['应答率30s']||0}}%</p>[m
[32m+[m						[32m<p><span style="width:55%;">问答比：&emsp;&ensp;</span>{{(oneData['客户问题数']/(oneData['客服回答数']||1)).toFixed(2)}}%</p>[m
[32m+[m						[32m<p><span style="width:55%;">30s应答率：</span>{{oneData['应答率30s']||0}}%</p>[m
 					</div>[m
 				</div>[m
 			</div>[m
 			<div class="col-md-3 col-lg-3 text-center">[m
 				<div class="box_info">[m
 					<div class="total">[m
[31m-						<h4>平均会话时长(分钟)</h4>[m
[32m+[m						[32m<h3>平均会话时长(分钟)</h3>[m
 						<strong>{{oneData['平均会话时长']}}</strong>[m
 					</div>[m
 					<div class="rate">[m
[31m-						<p>平均首次响应时间(分钟)：{{oneData['平均首次响应时长']}}</p>[m
[31m-						<p>平均响应时间(分钟)：{{(oneData['平均响应时长'])}}</p>[m
[32m+[m						[32m<p><span style="width:70%;">平均首次响应时间(分钟)：</span>{{oneData['平均首次响应时长']}}</p>[m
[32m+[m						[32m<p><span style="width:70%;">平均响应时间(分钟)：&emsp;&emsp;</span>{{(oneData['平均响应时长'])}}</p>[m
 					</div>[m
 				</div>[m
 			</div>[m
 			<div class="col-md-3 col-lg-3 text-center">[m
 				<div class="box_info">[m
 					<div class="total">[m
[31m-						<h4>相对满意度</h4>[m
[32m+[m						[32m<h3>相对满意度</h3>[m
 						<strong>{{oneData['满意度']}}%</strong>[m
 					</div>[m
 					<div class="rate">[m
[31m-						<p>&emsp;&ensp;参评率：{{oneData['参评率']||0}}%</p>[m
[31m-						<p>一次性解决率：{{oneData['一次性解决率']||0}}%</p>[m
[32m+[m						[32m<p><span style="width:55%;">参评率：&emsp;&emsp;&emsp;</span>{{oneData['参评率']||0}}%</p>[m
[32m+[m						[32m<p><span style="width:55%;">一次性解决率：</span>{{oneData['一次性解决率']||0}}%</p>[m
 					</div>[m
 				</div>[m
 			</div>[m
[36m@@ -675,7 +671,7 @@[m
 				    },[m
 				    legend: {[m
 				        orient: 'vertical',[m
[31m-				        left: 430,[m
[32m+[m				[32m        left: 530,[m
 				        x:'left',[m
 				        y:'center',[m
 				        icon:'circle',[m
[36m@@ -690,7 +686,7 @@[m
 				            name: '',[m
 				            type: 'pie',[m
 				            radius : '70%',[m
[31m-				            center: ['200', '50%'],[m
[32m+[m				[32m            center: ['300', '50%'],[m
 				            data:[[m
 				                [m
 				            ],[m
[36m@@ -832,7 +828,7 @@[m
 							v.问题解决数_pieOption.series[0].data[1].value += val.解决方式.human;[m
 						}[m
 						[m
[31m-						if(val.满意统计 && !v.$api.isEmptyObj(val.满意统计)){   console.log(v.满意度_pieOption.series[0].data[0].value,val.满意统计.满意)                [m
[32m+[m						[32mif(val.满意统计 && !v.$api.isEmptyObj(val.满意统计)){[m[41m                   [m
 							v.满意度_pieOption.series[0].data[0].value += val.满意统计.满意;[m
 							v.满意度_pieOption.series[0].data[1].value += val.满意统计.不满意;[m
 							v.满意度_pieOption.series[0].data[2].value += val.满意统计.未评价;[m
[36m@@ -854,11 +850,11 @@[m
 					v.oneData.机器人解决率 = (v.问题解决数_pieOption.series[0].data[0].value/((v.问题解决数_pieOption.series[0].data[0].value+v.问题解决数_pieOption.series[0].data[1].value)||1)*100).toFixed(2);[m
 [m
 					v.oneData.平均首次响应时长 = (首次响应时长/(首次响应个数||1)/60).toFixed(2);[m
[31m-					v.oneData.平均响应时长 = (响应时长/(响应个数||1)/60).toFixed(2);   console.log(总会话时长/60,v.oneData.总会话量)[m
[32m+[m					[32mv.oneData.平均响应时长 = (响应时长/(响应个数||1)/60).toFixed(2);[m[41m  [m
 					v.oneData.平均会话时长 = (总会话时长/(v.oneData.总会话量||1)/60).toFixed(2);[m
 					v.oneData.应答率30s = ((v.响应时间_barOption.series[0].data[4]+ v.响应时间_barOption.series[0].data[3])/((v.响应时间_barOption.series[0].data[4]+ v.响应时间_barOption.series[0].data[3]+v.响应时间_barOption.series[0].data[2]+ v.响应时间_barOption.series[0].data[1]+v.响应时间_barOption.series[0].data[0])||1)*100).toFixed(2);[m
 					[m
[31m-					v.oneData.匹配率= v.oneData.机器人匹配数/(机器人回答数||1)*100;  console.log(v.满意度_pieOption.series[0].data[0].value,v.满意度_pieOption.series[0].data[1].value)[m
[32m+[m					[32mv.oneData.匹配率= v.oneData.机器人匹配数/(机器人回答数||1)*100;[m[41m  [m
 					v.oneData.满意度 = (v.满意度_pieOption.series[0].data[0].value/((v.满意度_pieOption.series[0].data[0].value+v.满意度_pieOption.series[0].data[1].value)||1)*100).toFixed(2);[m
 					v.oneData.参评率 = ((v.满意度_pieOption.series[0].data[0].value+v.满意度_pieOption.series[0].data[1].value)/(v.oneData.总会话量||1)*100).toFixed(2);[m
 					if(search.start==search.end){[m
[36m@@ -974,11 +970,12 @@[m
 	.report .box_info {top:100px;width:calc(100% - 10px); margin:10px 0;}[m
 	.resolve .box_info {top:0}[m
 	.resolve .date {margin-left:10px; margin-top:80px;}[m
[31m-	#pandect_data .part h3 {text-align:center; color:#101010; font-size:25px;;}[m
[32m+[m	[32mpandect_data .part h3 {text-align:center; color:#101010; font-size:25px;;}[m
 	.report .part h4 { font-size:16px; line-height:50px;}[m
 	#pandect_data .part h4 + p {text-align:center; }[m
 	.report .part > div {display:inline-block; vertical-align:top; }[m
[31m-	.report .part .rate p {line-height:30px; text-align:center;}[m
[32m+[m	[32m.report .part .rate p {line-height:26px; text-align:left;}[m
[32m+[m	[32m.report .part .rate p span {display:inline-block;  text-align:right; padding:0 10px;}[m
 	.report .map {display:inline-block; }[m
 	#pandect_data .satisfaction > div > div  {text-align:center;}[m
 	#pandect_data .satisfaction > div > div > div {display:inline-block;}[m
[1mdiff --git a/src/page/servicer/chatbox.vue b/src/page/servicer/chatbox.vue[m
[1mindex 99ea136..2c6f0a6 100644[m
[1m--- a/src/page/servicer/chatbox.vue[m
[1m+++ b/src/page/servicer/chatbox.vue[m
[36m@@ -1,7 +1,7 @@[m
 <template>[m
 	<div class="__chatbox"> [m
 		<bar :wrapper="'wrapper'" :scrollTop="session.scroll">[m
[31m-			<div :id="id">														[m
[32m+[m			[32m<div :id="id" ref="community_wrap">[m[41m														[m
 				<template v-if="showhistory" v-for="(c,i) in session.historys">[m
 						<div v-if="c.msg_type=='info2'">[m
 							<p v-if="c.info" class="infos text-center"><span class="opcity9">{{c.info_b}}</span>&emsp;{{c.info}}&emsp;<span class="opcity9">{{c.info_b}}</span></p>[m
[36m@@ -378,6 +378,28 @@[m
 					}[m
 				}[m
 			},*/[m
[32m+[m			[32m'session.historys':{[m
[32m+[m				[32mhandler:function(n){[m
[32m+[m					[32msetTimeout(()=>{[m
[32m+[m						[32mlet area = this.$refs.community_wrap;[m
[32m+[m						[32mif(area){[m
[32m+[m							[32mlet h = 0-area.offsetHeight;[m
[32m+[m							[32mthis.session.scroll.top = h>0?0:h;[m
[32m+[m						[32m}[m
[32m+[m					[32m},300);[m
[32m+[m				[32m},deep:true,[m
[32m+[m			[32m},[m
[32m+[m			[32m'session.tell':{[m
[32m+[m				[32mhandler:function(n){[m
[32m+[m					[32msetTimeout(()=>{[m
[32m+[m						[32mlet area = this.$refs.community_wrap;[m
[32m+[m						[32mif(area){[m
[32m+[m							[32mlet h = 0-area.offsetHeight;[m
[32m+[m							[32mthis.session.scroll.top = h>0?0:h;[m
[32m+[m						[32m}[m
[32m+[m					[32m},300);[m
[32m+[m				[32m},deep:true,[m
[32m+[m			[32m},[m
 			'finds':{[m
 				handler:function(n){[m
 					this.find.text = n;[m
[1mdiff --git a/src/page/servicer/main.vue b/src/page/servicer/main.vue[m
[1mindex e1b2676..10b5cc7 100644[m
[1m--- a/src/page/servicer/main.vue[m
[1m+++ b/src/page/servicer/main.vue[m
[36m@@ -275,15 +275,7 @@[m
 		        }[m
 		        if(v.current!=v.ids[data.session_id].index){[m
 					v.sessions[v.ids[data.session_id].index].news =  (v.sessions[v.ids[data.session_id].index].news+1).toString().length>2?'99+':v.sessions[v.ids[data.session_id].index].news+1;[m
[31m-		        }else{[m
[31m-					setTimeout(()=>{[m
[31m-						let area = document.getElementById('community_area');[m
[31m-						if(area){[m
[31m-							let h = 0-area.offsetHeight;[m
[31m-							v.sessions[v.ids[data.session_id].index].scroll.top = h>0?0:h;[m
[31m-						}[m
[31m-					},300);[m
[31m-				}[m
[32m+[m		[32m        }[m
 	       		if(v.current===''){[m
 	       			for(let i in v.ids){[m
 						if(v.ids[i].status==1){[m
[36m@@ -524,10 +516,6 @@[m
 					if(data.list.length>0){[m
 						v.sessions[i].historys.unshift({msg_type:'info',info:'没有更多了'});[m
 					}[m
[31m-					setTimeout(()=>{      [m
[31m-						let h = 0-document.getElementById('community_area').offsetHeight;[m
[31m-						v.sessions[v.current].scroll.top = h>0?0:h;[m
[31m-					},300) [m
 				})[m
 			},[m
 			codeTo中文(code){    [m
[36m@@ -549,15 +537,6 @@[m
 		watch:{[m
 			current(n,o){[m
 				let v = this;[m
[31m-				if(n!==''){[m
[31m-					setTimeout(()=>{[m
[31m-						let area = document.getElementById('community_area');[m
[31m-						if(area){[m
[31m-							let h = 0-area.offsetHeight;[m
[31m-							v.sessions[n].scroll.top = h>0?0:h;[m
[31m-						}[m
[31m-					},300);[m
[31m-				}[m
 				if(n!=='' && this.sessions[n].source===''){[m
 					this.getSessionDetail(n);[m
 				}[m
[1mdiff --git a/src/page/servicer/session.vue b/src/page/servicer/session.vue[m
[1mindex 58b511b..dec03d2 100644[m
[1m--- a/src/page/servicer/session.vue[m
[1m+++ b/src/page/servicer/session.vue[m
[36m@@ -58,7 +58,7 @@[m
 					<p v-if="kf_state==1&&sessions[current].status==1" class="pull-right pointer"><a @click="open转接()">转接</a>&emsp;<a @click="endSession">结束服务</a></p>[m
 				</div>[m
 				<div class="area">[m
[31m-					<chatbox :session="sessions[current]" :id="'community_area'"></chatbox>[m
[32m+[m					[32m<chatbox :session="sessions[current]" ></chatbox>[m
 				</div>[m
 				<div class="say" :class="(say.focus?'focus ':'')+'kfState'+kf_state">[m
 					<div class="control">[m
[36m@@ -76,10 +76,11 @@[m
 							<span v-if="e.uri==undefined">{{e.txt}}</span>[m
 						</b>[m
 					</div>[m
[31m-					<!--<bar :wrapper="'wrapper'">-->[m
[31m-						<div @keydown="sayKeyDown"  @input="inputChange" @paste="()=>{if(input.type=='txt'){pasteHandler();}}" ref='write' id="write" class="write" contenteditable="true" placeholder="小提示：在输入框内按下“Ctrl+Enter”,可以换行输入内容"> </div>[m
[31m-						<!--<textarea v-if="input.type=='txt'" v-model="input.text" @keydown="sayKeyDown" @input="inputChange" @focus="say.focus=true" @blur="say.focus=false" ref='write' class="write" multiple="multiple" placeholder="小提示：在输入框内按下“Ctrl+Enter”,可以换行输入内容"></textarea>-->[m
[31m-					<!--</bar>-->[m
[32m+[m[41m					[m
[32m+[m					[32m<div @keydown="sayKeyDown"  @input="inputChange" @paste="()=>{if(input.type=='txt'){pasteHandler();}}" ref='write' id="write" class="write" contenteditable="true" placeholder="小提示：在输入框内按下“Ctrl+Enter”,可以换行输入内容"> </div>[m
[32m+[m					[32m<!--<textarea v-if="input.type=='txt'" v-model="input.text" @keydown="sayKeyDown" @input="inputChange" @focus="say.focus=true" @blur="say.focus=false" ref='write' class="write" multiple="multiple" placeholder="小提示：在输入框内按下“Ctrl+Enter”,可以换行输入内容"></textarea>-->[m
[32m+[m[41m						[m
[32m+[m					[32m</bar>[m
 					<div class="hint" v-if="answer.show || 快捷回复.show" ref="hint">[m
 						<bar :wrapper="'wrapper'" :scrollTop="answer" v-show="answer.show">[m
 							<ul>[m
[36m@@ -419,12 +420,12 @@[m
 				setTimeout(function(){[m
 					v.answer.index=0; v.快捷回复.index=0;[m
 					v.answer.show=false;v.快捷回复.show=false;[m
[31m-				},100);[m
[32m+[m				[32m},50);[m
 			},[m
 			sayKeyDown(e){  [m
 				let v= this;[m
[31m-				let answer_h = this.$refs.hint.offsetHeight;[m
[31m-				let answer_t = this.$refs.hint.scrollHeight;[m
[32m+[m				[32mlet answer_h = this.$refs.hint?this.$refs.hint.offsetHeight:0;[m
[32m+[m				[32mlet answer_t = this.$refs.hint?this.$refs.hint.scrollHeight:0;[m
 				if((v.answer.show && answer_h)||(v.快捷回复.show && answer_h)){[m
 					let source = v.answer.show?v.answer:v.快捷回复;[m
 					if(e.keyCode==13){[m
[36m@@ -510,10 +511,6 @@[m
 				v.sessions[v.current].tell.push(tell);[m
 				v.sessions[v.current].tell_no_img.push(tell_no_img);[m
 				let index = v.sessions[v.current].tell.length-1;[m
[31m-				setTimeout(()=>{[m
[31m-					let h = 0-document.getElementById('community_area').offsetHeight[m
[31m-					v.sessions[v.current].scroll.top = h>0?0:h;[m
[31m-				},300);  [m
 				v.$api.ajaxNoLoading('/chats/reply','post',data)[m
 					.then(datas=>{ console.log('hehe')[m
 						v.sessions[v.current].tell[index].send=1; [m
[36m@@ -698,16 +695,8 @@[m
 				v.$api.ajaxNoLoading('/chats/reply','post',data)[m
 					.then(datas=>{[m
 						v.sessions[v.current].tell[index].send = 1;[m
[31m-						setTimeout(()=>{[m
[31m-							let h = 0-document.getElementById('community_area').offsetHeight[m
[31m-							v.sessions[v.current].scroll.top = h>0?0:h;[m
[31m-						},300) [m
 					}).catch(datas=>{[m
 						v.sessions[v.current].tell[index].send = -1;[m
[31m-						setTimeout(()=>{[m
[31m-							let h = 0-document.getElementById('community_area').offsetHeight[m
[31m-							v.sessions[v.current].scroll.top = h>0?0:h;[m
[31m-						},300) [m
 					})[m
 			},[m
 			errorUpload(msg){[m
[36m@@ -802,15 +791,17 @@[m
 	[m
 	#session .section .control {height:60px; line-height:61px; border-top:1px solid #d3e1f0; padding:0 20px; }[m
 	#session .section .control > * {margin-right:10px;}[m
[32m+[m[41m	[m
 	#session .section .say .emoj {position:absolute; left:8px; bottom:265px; width:calc(100% - 17px); font-size:0; background:#fff;}[m
 	#session .section .say .emoj b {display:inline-block; vertical-align:top; width:30px; height:30px; line-height:30px; text-align:center; border:0.5px solid #eee;}[m
[31m-	#session .section .say {height:265px;background:#f7fbff; position:relative; }[m
[32m+[m	[32m#session .section .say {height:265px;background:#f7fbff; position:relative; overflow-x:hidden;}[m
 	#session .section .say button {position:absolute; bottom:20px; right:20px; background:rgba(0,0,0,0);}[m
 	#session .section .say.focus {background:#fff;}[m
 	#session .section .say.kfState0:after {content:''; display:block; position:absolute; width:100%; height:100%; top:0; left:0; background:rgba(255,255,255,0.3);}[m
 	#session .section .say.kfState0:hover {cursor:not-allowed;}[m
 	#session .section .say .hint .wrapper {max-height:160px; width:100%;}[m
[31m-	#session .section .say .write {width:100%; min-height:140px; font-size:14px; outline:none; border:none; background:rgba(0,0,0,0); resize: none; padding:0 20px;}[m
[32m+[m[41m	[m
[32m+[m	[32m#session .section .say .write {width:calc(100% + 42px); height:140px; font-size:14px; outline:none; border:none; background:rgba(0,0,0,0); overflow-y:auto ; resize: none; padding:0 60px 0 20px;}[m
 	#session .section .say .write:empty:before{content: attr(placeholder);color:#bbb;}[m
 	#session .section .say .write::placeholder { color:#d2dff0;}[m
 	#session .section .say .write:focus{content:none;}[m
[1mdiff --git a/src/page/user/account.vue b/src/page/user/account.vue[m
[1mindex fd06626..d0c6c09 100644[m
[1m--- a/src/page/user/account.vue[m
[1m+++ b/src/page/user/account.vue[m
[36m@@ -44,7 +44,7 @@[m
 						<th>角色</th>[m
 						<th>是否可用</th>[m
 						<th>创建时间</th>[m
[31m-						<th v-if="$store.state.role==1" authority="'下线客服'">强制下线</th>[m
[32m+[m						[32m<th authority="'下线客服'">强制下线</th>[m
 						<th>操作</th>[m
 					</tr>[m
 					<tbody>[m
[36m@@ -66,7 +66,7 @@[m
 					</tbody>[m
 				</table>[m
 			</div>[m
[31m-			<div class="pagination_wrap">[m
[32m+[m			[32m<div class="pagination_wrap" v-if="total>0">[m
 				<pagination :page="page" :total="total" v-on:pageTurn="pageTurn"></pagination>[m
 			</div>[m
 		</div>[m

[33mcommit 8b904b012c6f5006b490d864b89bb6d519676f46[m
Merge: f529646 31e2491
Author: xuwei <weixu@webot.co>
Date:   Wed Sep 20 14:25:10 2017 +0800

    Merge branch 'v2.0' of 192.168.3.101:jianglinlin/data-admin-ui into v2.0

[33mcommit f529646521547c66b48efcf8575c888a1ea14bf3[m
Author: xuwei <weixu@webot.co>
Date:   Wed Sep 20 14:24:54 2017 +0800

    快捷回复的隔空格匹配

[1mdiff --git a/config/index.js b/config/index.js[m
[1mindex 7becbd1..3359a33 100644[m
[1m--- a/config/index.js[m
[1m+++ b/config/index.js[m
[36m@@ -2,9 +2,9 @@[m
 var path = require('path')[m
 [m
 //var web_site = 'http://192.168.3.94:8882'[m
[31m-// var web_site = 'http://192.168.3.21:8882'[m
[32m+[m[32mvar web_site = 'http://192.168.3.21:8882'[m
 //var web_site = 'http://admin.test.webot.ai'[m
[31m-var  web_site = 'http://znd.test.webot.ai'[m
[32m+[m[32m// var  web_site = 'http://znd.test.webot.ai'[m
 module.exports = {[m
   build: {[m
     env: require('./prod.env'),[m
[1mdiff --git a/src/page/servicer/session.vue b/src/page/servicer/session.vue[m
[1mindex 2f8eefc..ed07317 100644[m
[1m--- a/src/page/servicer/session.vue[m
[1m+++ b/src/page/servicer/session.vue[m
[36m@@ -177,7 +177,7 @@[m
 				headers:{[m
 					Auth:this.$store.state.user.token,[m
 				},    //上传头部[m
[31m-				[m
[32m+[m				[32mqb_list:[],[m
 				input:{[m
 					text:'',[m
 					type:'txt',[m
[36m@@ -352,7 +352,7 @@[m
 						}else{[m
 							v.turn.groups[relate[gid]].users.push(uo[uid]);[m
 						}[m
[31m-					}   console.log(v.turn.groups)[m
[32m+[m					[32m}[m[41m   [m
 					v.turn.show=true;[m
 				})[m
 			},[m
[36m@@ -490,7 +490,7 @@[m
 			},[m
 			replyed(str=undefined){   [m
 				let v =this;[m
[31m-				let text= str?str:this.$refs.write.innerHTML;  console.log(text)[m
[32m+[m				[32mlet text= str?str:this.$refs.write.innerHTML;[m
 				this.$refs.write.innerHTML = '';   [m
 				if(text.trim()=="") return;[m
 				let data = {[m
[36m@@ -523,7 +523,7 @@[m
 					v.sessions[v.current].scroll.top = h>0?0:h;[m
 				},300);  [m
 				v.$api.ajaxNoLoading('/chats/reply','post',data)[m
[31m-					.then(datas=>{ console.log('hehe')[m
[32m+[m					[32m.then(datas=>{[m
 						v.sessions[v.current].tell[index].send=1; [m
 					}).catch(err=>{[m
 						v.sessions[v.current].tell[index].send=-1;[m
[36m@@ -535,10 +535,13 @@[m
 			},[m
 			strToHtml(str,text){[m
 				if(!str) return;[m
[32m+[m				[32mlet reg1 = new RegExp(" ",'g');[m
[32m+[m				[32mtext = text.replace("&nbsp;", "");[m
[32m+[m				[32mvar word = text.replace(reg1, "|");[m
 				/*let index = str.indexOf(text);[m
 				let html = str.slice(0,index) +'<font>'+text+'</font>'+str.slice(index+text.length);*/[m
[31m-				let reg = new RegExp(text,'g');[m
[31m-				return str.replace(text,'<font>'+text+'</font>');[m
[32m+[m				[32mlet reg = new RegExp(word,'g');[m
[32m+[m				[32mreturn str.replace(reg, function(word){return '<font>'+word+'</font>'});[m
 				[m
 			},[m
 			//毫秒转时分秒[m
[36m@@ -578,7 +581,8 @@[m
 			    return result;  [m
 			  [m
 			},[m
[31m-			inputChange(){    console.log('inputChange')[m
[32m+[m			[32minputChange(){[m[41m    [m
[32m+[m
 				let v = this;[m
 				let text = v.$refs.write.innerHTML.trim();  [m
 				v.快捷回复.filtered =[];[m
[36m@@ -586,20 +590,25 @@[m
 				if(text=='') {[m
 					return ;[m
 				}[m
[32m+[m				[32mtext = text.replace("&nbsp;", "")[m
 				if(text[0]=='#'){[m
[32m+[m					[32mvar test = this.test[m
[32m+[m					[32m// v.qb_list = this._fomatFBs(v.快捷回复s);[m
 					v.快捷回复.show = true;[m
 					v.answer.show=false;[m
 					text = text.slice(1);[m
 					v.快捷回复.index=0;[m
 					v.快捷回复.filtered = [['','',text]];[m
[32m+[m					[32m// this._filterQuickFBArr()[m
[32m+[m					[32mvar texts = text.split(" ")[m
 					for(let i in v.快捷回复s){[m
[31m-						if(i.indexOf(text)!=-1){[m
[32m+[m						[32mif(test(i, texts)){[m
 							for(let j in v.快捷回复s[i]){[m
 								v.快捷回复.filtered.push([i,j,v.快捷回复s[i][j]]);[m
 							}[m
 						}else{[m
 							for(let j in v.快捷回复s[i]){[m
[31m-								if(j.indexOf(text)!=-1 || v.快捷回复s[i][j].indexOf(text)!=-1){[m
[32m+[m								[32mif(test(j, texts) || test(v.快捷回复s[i][j], texts)){[m
 									v.快捷回复.filtered.push([i,j,v.快捷回复s[i][j]]);[m
 								}[m
 							}[m
[36m@@ -618,6 +627,43 @@[m
 					v.answer.filtered = v.answer.filtered.length==1?[]:v.answer.filtered;[m
 				}[m
 			},[m
[32m+[m			[32mtest(str, list){[m
[32m+[m				[32mfor(var i=0,len=list.length; i<len; i++){[m
[32m+[m					[32mif(str != undefined && (str.indexOf(list[i])!=-1)){[m
[32m+[m						[32mreturn true;[m
[32m+[m					[32m}[m
[32m+[m				[32m}[m
[32m+[m				[32mreturn false;[m
[32m+[m			[32m},[m
[32m+[m			[32m// _fomatFBs(fbObj){[m
[32m+[m			[32m// 	var resp = [];[m
[32m+[m			[32m// 	for(let key1 in fbObj) {[m
[32m+[m			[32m// 		var _rp = [];[m
[32m+[m			[32m// 		var fbs = fbObj[key1];[m
[32m+[m			[32m// 		for(let key2 in fbs){[m
[32m+[m			[32m// 			_rp.push([key1, key2, fbs[key2]]);[m
[32m+[m			[32m// 		}[m
[32m+[m			[32m// 		resp.push(_rp);[m
[32m+[m			[32m// 	}[m
[32m+[m			[32m// 	return resp;[m
[32m+[m			[32m// },[m
[32m+[m			[32m// _filterQuickFBArr(w, wordss){[m
[32m+[m			[32m// 	var resp=[];[m
[32m+[m			[32m// 	for(var i=0,len=wordss.length; i<len; i++){[m
[32m+[m			[32m// 		var _rp = _filterArr(w, wordss[i])[m
[32m+[m			[32m// 		if(_rp)[m
[32m+[m			[32m// 			resp.push(_rp)[m
[32m+[m			[32m// 	}[m
[32m+[m			[32m// 	return resp;[m
[32m+[m			[32m// },[m
[32m+[m			[32m// _filterArr(w, wordArr){[m
[32m+[m			[32m// 	for(var i=0,len=wordArr.length; i<len; i++){[m
[32m+[m			[32m// 		if(wordArr[i].indexOf(w)!=-1) {[m
[32m+[m			[32m// 			return wordArr[m
[32m+[m			[32m// 		}[m
[32m+[m			[32m// 	}[m
[32m+[m			[32m// 	return false;[m
[32m+[m			[32m// },[m
 			pasteHandler(e){[m
 				let v= this;[m
 				let _this = v.$refs.write;[m
[1mdiff --git a/src/page/setting/companyInfo.vue b/src/page/setting/companyInfo.vue[m
[1mindex a1e66cc..65ea3bd 100644[m
[1m--- a/src/page/setting/companyInfo.vue[m
[1m+++ b/src/page/setting/companyInfo.vue[m
[36m@@ -97,6 +97,7 @@[m
                     this.$message({type: 'error', message: msg})[m
                     return ;[m
                 }[m
[32m+[m[32m                console.log("company", this.company)[m
                 this.$api.ajax('/company','put', this.company).then(data=>{[m
                         this.$message({[m
                             type: 'success',[m

[33mcommit 31e2491008be24a75acfbe5da30cb9cc0259c56b[m
Author: lijianhui <jianhuili@webot.co>
Date:   Tue Sep 19 22:13:22 2017 +0800

    1

[1mdiff --git a/dist.zip b/dist.zip[m
[1mindex 3013311..9790e3c 100644[m
Binary files a/dist.zip and b/dist.zip differ
[1mdiff --git a/src/page/servicer/guestbook.vue b/src/page/servicer/guestbook.vue[m
[1mindex 9dd66b2..2b330a4 100644[m
[1m--- a/src/page/servicer/guestbook.vue[m
[1m+++ b/src/page/servicer/guestbook.vue[m
[36m@@ -38,8 +38,8 @@[m
 		<div class="section">[m
 			<div v-if="current!==''">[m
 				<h1 class="first">留言信息[m
[31m-					<span v-if="留言s[current].status==0" @click="changeStatus(1)" class="c1 unselect pointer">接单</span>[m
[31m-					<span v-if="留言s[current].status==1" class="c2 unselect pointer">已指派</span>[m
[32m+[m					[32m<span v-if="留言s[current]&&留言s[current].status==0" @click="changeStatus(1)" class="c1 unselect pointer">接单</span>[m
[32m+[m					[32m<span v-if="留言s[current]&&留言s[current].status==1" class="c2 unselect pointer">已指派</span>[m
 				</h1>[m
 				<bar :wrapper="'wrapper'">[m
 					<chatbox :session="留言s[current]" :showhistory="false"></chatbox>[m
[1mdiff --git a/src/page/servicer/session.vue b/src/page/servicer/session.vue[m
[1mindex cadd659..58b511b 100644[m
[1m--- a/src/page/servicer/session.vue[m
[1m+++ b/src/page/servicer/session.vue[m
[36m@@ -417,7 +417,7 @@[m
 				document.execCommand('insertHTML',false,s);[m
 				[m
 				setTimeout(function(){[m
[31m-					[m
[32m+[m					[32mv.answer.index=0; v.快捷回复.index=0;[m
 					v.answer.show=false;v.快捷回复.show=false;[m
 				},100);[m
 			},[m
[36m@@ -436,7 +436,7 @@[m
 					}[m
 					if(e.keyCode==38){[m
 						source.index=source.index==0?0:source.index-1;[m
[31m-						if(0-source.index*30<answer_t){[m
[32m+[m						[32mif(0-(source.index-2)*30<answer_t){[m
 							source.top=0-(source.index-2)*30;[m
 						}[m
 						if(source.index==0){[m
[36m@@ -447,7 +447,7 @@[m
 					}[m
 					if(e.keyCode==40){[m
 						source.index=source.index==source.filtered.length-1?source.index:source.index+1;[m
[31m-						if(source.index*30>answer_t){[m
[32m+[m						[32mif((source.index+1)*30>answer_t){[m
 							source.top=0-(source.index-2)*30;[m
 						}[m
 						e.preventDefault();[m

[33mcommit 443f828917a0329d43372d6e654c619d5c99d6c8[m
Author: lijianhui <jianhuili@webot.co>
Date:   Tue Sep 19 21:51:44 2017 +0800

    关于快捷回复的问题

[1mdiff --git a/dist.zip b/dist.zip[m
[1mindex 0d49727..3013311 100644[m
Binary files a/dist.zip and b/dist.zip differ
[1mdiff --git a/src/page/servicer/session.vue b/src/page/servicer/session.vue[m
[1mindex e2423fe..cadd659 100644[m
[1m--- a/src/page/servicer/session.vue[m
[1m+++ b/src/page/servicer/session.vue[m
[36m@@ -144,9 +144,9 @@[m
 			  			<p v-if="turn.groups.length==0" class="vertical-center text-center">没有可转接的客服组</p>[m
 			  		</div>[m
 			  	</div><br />[m
[31m-			  	<div class="turn_foot">[m
[32m+[m			[41m  [m	[32m<!--<div class="turn_foot">[m
 			  		<el-input type="textarea" v-model="turn.remark" placeholder="备注"></el-input>[m
[31m-			  	</div>[m
[32m+[m			[41m  [m	[32m</div>-->[m
 			</div>[m
 			<div slot="footer" class="dialog-footer">[m
 			    <el-button @click="turn.show = false">取 消</el-button>[m
[36m@@ -404,6 +404,8 @@[m
 			},[m
 			select快捷字段(s){[m
 				let v= this;[m
[32m+[m				[32mthis.$refs.write.innerHTML = '';[m
[32m+[m				[32mthis.$refs.write.focus();[m
 				if(document.activeElement.id!='write'){[m
 					let sel = window.getSelection();[m
 					let range = document.createRange();[m
[36m@@ -434,8 +436,8 @@[m
 					}[m
 					if(e.keyCode==38){[m
 						source.index=source.index==0?0:source.index-1;[m
[31m-						if(0-source.index*30<this.$refs.hint.scrollTop){[m
[31m-							source.top=0-source.index*30;[m
[32m+[m						[32mif(0-source.index*30<answer_t){[m
[32m+[m							[32msource.top=0-(source.index-2)*30;[m
 						}[m
 						if(source.index==0){[m
 							source.top=0;[m
[36m@@ -445,8 +447,8 @@[m
 					}[m
 					if(e.keyCode==40){[m
 						source.index=source.index==source.filtered.length-1?source.index:source.index+1;[m
[31m-						if(source.index*30>this.$refs.hint.scrollTop){[m
[31m-							source.top=0-source.index*30;[m
[32m+[m						[32mif(source.index*30>answer_t){[m
[32m+[m							[32msource.top=0-(source.index-2)*30;[m
 						}[m
 						e.preventDefault();[m
 						e.stopPropagation();[m

[33mcommit fba583177d793e714040445d8448ebc566319192[m
Author: lijianhui <jianhuili@webot.co>
Date:   Tue Sep 19 21:32:48 2017 +0800

    1

[1mdiff --git a/dist.zip b/dist.zip[m
[1mindex 49f7cc5..0d49727 100644[m
Binary files a/dist.zip and b/dist.zip differ
[1mdiff --git a/src/page/servicer/history.vue b/src/page/servicer/history.vue[m
[1mindex 99ed5ca..8a69c32 100644[m
[1m--- a/src/page/servicer/history.vue[m
[1m+++ b/src/page/servicer/history.vue[m
[36m@@ -311,7 +311,7 @@[m
 	#sessions_history .search_area .search > .el-input {width:200px;}[m
 	#sessions_history .search_area .el-input-group__prepend {width:30%;}[m
 	#sessions_history .session_detail > div {display:inline-block; vertical-align:top; width:59%;}[m
[31m-	#sessions_history .session_detail{position:fixed; top:0; right:0px; z-index:5; width:1000px; height:calc(100vh - 100px); background:#fff; border:0.5px solid #d3e1f0;}[m
[32m+[m	[32m#sessions_history .session_detail{position:fixed; top:70px; right:0px; z-index:35; width:1000px; height:calc(100vh - 100px); background:#fff; border:0.5px solid #d3e1f0;}[m
 	#sessions_history .session_detail .close {position:absolute; top:2px; right:10px; font-size:40px; font-weight:100;}[m
 	#sessions_history .session_detail > div  {width:59%; height:100%; background: rgb(247, 251, 255);}[m
 	#sessions_history .session_detail > div + div {width:40%; background:#fff;}[m

[33mcommit e1686dec783b1860f46600856b25323d85139938[m
Author: lijianhui <jianhuili@webot.co>
Date:   Tue Sep 19 21:16:45 2017 +0800

    0

[1mdiff --git a/dist.zip b/dist.zip[m
[1mindex 78fb8a8..49f7cc5 100644[m
Binary files a/dist.zip and b/dist.zip differ
[1mdiff --git a/src/page/index.vue b/src/page/index.vue[m
[1mindex 8150a74..8c09318 100644[m
[1m--- a/src/page/index.vue[m
[1m+++ b/src/page/index.vue[m
[36m@@ -305,7 +305,7 @@[m
 			this.getTotalData();[m
 		},[m
 		mounted(){[m
[31m-			this.清除数据痕迹();[m
[32m+[m[41m			[m
 		},[m
 		computed: {[m
 			...mapGetters(['getUser']),[m
[36m@@ -323,6 +323,7 @@[m
 				var v = this;[m
 				v.$api.ajax(v.$uri.company.index, 'get',{start:v.$api.dateFormat('yyyy-MM-dd'),end:v.$api.dateFormat('yyyy-MM-dd')})[m
 					.then(result => {[m
[32m+[m						[32mv.清除数据痕迹();[m
 						//排序[m
 						let data = result.result;[m
 						result.kf.forEach((val,i)=>{[m

[33mcommit 993047d0a925eeaa84ad6260e8dfd43c1cdd3369[m
Author: lijianhui <jianhuili@webot.co>
Date:   Tue Sep 19 21:11:06 2017 +0800

    0

[1mdiff --git a/dist.zip b/dist.zip[m
[1mindex 67a0014..78fb8a8 100644[m
Binary files a/dist.zip and b/dist.zip differ
[1mdiff --git a/src/page/index.vue b/src/page/index.vue[m
[1mindex 3b8f77d..8150a74 100644[m
[1m--- a/src/page/index.vue[m
[1m+++ b/src/page/index.vue[m
[36m@@ -81,23 +81,28 @@[m
 			</div>[m
 			<div class="row">[m
 				<div class="box col-lg-12 col-md-12">[m
[31m-					<h2>今日客服活动</h2>[m
[32m+[m					[32m<h2>今日客服活动<small>（部分数据开发中）</small></h2>[m
 					<table >[m
 						<tr>[m
 							<th>客服</th>[m
 							<th>在线状态</th>[m
 							<th>当前接待量</th>[m
[31m-							<!--<th>累计会话量</th>[m
[32m+[m							[32m<th>累计会话量</th>[m
 							<th>累计消息量</th>[m
 							<th>相对满意度</th>[m
 							<th>首次在线时间</th>[m
[31m-							<th>累计在线时间</th>-->[m
[32m+[m							[32m<th>累计在线时间</th>[m
 						</tr>[m
 						<tbody>[m
 							<tr v-for="kf in kfs">[m
 								<td><i class="fa fa-user"></i>&nbsp;{{kf.姓名}}</td>[m
 								<td><i class="o" :class="kf.在线状态=='在线'?'online':''"></i>&nbsp;{{kf.在线状态}}</td>[m
 								<td>{{kf.当前接待量}}</td>[m
[32m+[m								[32m<td>--</td>[m
[32m+[m								[32m<td>--</td>[m
[32m+[m								[32m<td>--</td>[m
[32m+[m								[32m<td>--</td>[m
[32m+[m								[32m<td>--</td>[m
 							</tr>[m
 						</tbody>[m
 					</table>[m
[36m@@ -266,6 +271,12 @@[m
 				        minInterval:1,[m
 				        min:0,[m
 				        max:this.fn_mixin计算折线或柱状图的最大值,[m
[32m+[m				[32m        axisLine:{[m
[32m+[m				[41m        [m	[32mlineStyle:{[m
[32m+[m				[41m        [m		[32mcolor:'#ccc',[m
[32m+[m				[41m        [m		[32mopacity:0.5,[m
[32m+[m				[41m        [m	[32m}[m
[32m+[m				[32m        },[m
 				    },[m
 				    series: [[m
 				        {[m
[36m@@ -293,6 +304,9 @@[m
 		created() {  [m
 			this.getTotalData();[m
 		},[m
[32m+[m		[32mmounted(){[m
[32m+[m			[32mthis.清除数据痕迹();[m
[32m+[m		[32m},[m
 		computed: {[m
 			...mapGetters(['getUser']),[m
 		},[m
[36m@@ -309,7 +323,6 @@[m
 				var v = this;[m
 				v.$api.ajax(v.$uri.company.index, 'get',{start:v.$api.dateFormat('yyyy-MM-dd'),end:v.$api.dateFormat('yyyy-MM-dd')})[m
 					.then(result => {[m
[31m-						v.清除数据痕迹();[m
 						//排序[m
 						let data = result.result;[m
 						result.kf.forEach((val,i)=>{[m
[36m@@ -554,7 +567,14 @@[m
 		}[m
 	}[m
 	[m
[31m-	[m
[32m+[m	[32m.box_info {[m
[32m+[m		[32mdisplay: inline-block;[m
[32m+[m		[32mwidth: 250px;[m
[32m+[m		[32mpadding: 20px 0 0;[m
[32m+[m		[32mmargin: 10px;[m
[32m+[m		[32mbackground: #fff;[m
[32m+[m		[32mbox-shadow: 1px 1px 5px 3px #f3f3f3;[m
[32m+[m	[32m}[m
 	.box_info>div:first-child {[m
 		text-align: center;[m
 		line-height: 60px;[m
[1mdiff --git a/src/page/mixin/图表.js b/src/page/mixin/图表.js[m
[1mindex 439ae01..d2dc26a 100644[m
[1m--- a/src/page/mixin/图表.js[m
[1m+++ b/src/page/mixin/图表.js[m
[36m@@ -8,8 +8,8 @@[m [mexport default {[m
 	},[m
   	methods:{[m
   		fn_mixin计算折线或柱状图的最大值(value){ [m
[31m-        	if(value.max<10){[m
[31m-        		return value.max<5?value.max+5:value.max+2;[m
[32m+[m[41m        [m	[32mif(value.max<5){[m
[32m+[m[41m        [m		[32mreturn value.max+5;[m
         	}else{[m
         		let digit = 1,max=value.max;[m
         		while(max>10){[m
[1mdiff --git a/src/page/report/pandect.vue b/src/page/report/pandect.vue[m
[1mindex 248fc30..3036b06 100644[m
[1m--- a/src/page/report/pandect.vue[m
[1m+++ b/src/page/report/pandect.vue[m
[36m@@ -266,7 +266,6 @@[m
 				        {[m
 				            name:'总会话量',[m
 				            type:'line',[m
[31m-				            xAxisIndex: 1,[m
 				            smooth:true,[m
 				            data:[][m
 				        },[m
[36m@@ -274,14 +273,12 @@[m
 				            name:'机器人会话量',[m
 				            type:'line',[m
 				            smooth:true,[m
[31m-				            xAxisIndex: 1,[m
 				            data:[][m
 				        },[m
 				        {[m
 				            name:'人工会话量',[m
 				            type:'line',[m
 				            smooth:true,[m
[31m-				            xAxisIndex: 1,[m
 				            data:[][m
 				        }[m
 				    ][m
[36m@@ -327,21 +324,18 @@[m
 				            name:'消息总数',[m
 				            type:'line',[m
 				            smooth:true,[m
[31m-				            xAxisIndex: 1,[m
 				            data:[][m
 				        },[m
 				        {[m
 				            name:'机器人消息量',[m
 				            type:'line',[m
 				            smooth:true,[m
[31m-				            xAxisIndex: 1,[m
 				            data:[][m
 				        },[m
 				        {[m
 				            name:'人工消息量',[m
 				            type:'line',[m
 				            smooth:true,[m
[31m-				            xAxisIndex: 1,[m
 				            data:[][m
 				        }[m
 				    ][m

[33mcommit 53477b3eca729e9528ccda479da843060829d1ef[m
Author: lijianhui <jianhuili@webot.co>
Date:   Tue Sep 19 20:45:53 2017 +0800

    合并打包

[1mdiff --git a/dist.zip b/dist.zip[m
[1mindex 69ceee4..67a0014 100644[m
Binary files a/dist.zip and b/dist.zip differ
[1mdiff --git a/src/page/servicer/main.vue b/src/page/servicer/main.vue[m
[1mindex bb341a3..e1b2676 100644[m
[1m--- a/src/page/servicer/main.vue[m
[1m+++ b/src/page/servicer/main.vue[m
[36m@@ -618,5 +618,5 @@[m
 [m
 <style>[m
 	#servicer {width:100%; min-height:calc(100vh - 70px);}[m
[31m-	#servicer .select_model {position:absolute; top:25px; right:100px;}[m
[32m+[m	[32m#servicer .select_model {position:absolute; top:25px; right:100px; z-index:20;}[m
 </style>[m
\ No newline at end of file[m

[33mcommit d9c1631148c07555dad6056e39e757bb86c14301[m
Author: lijianhui <jianhuili@webot.co>
Date:   Tue Sep 19 20:34:38 2017 +0800

    合并打包

[1mdiff --git a/dist.zip b/dist.zip[m
[1mindex ae01eb8..69ceee4 100644[m
Binary files a/dist.zip and b/dist.zip differ
[1mdiff --git a/src/page/index.vue b/src/page/index.vue[m
[1mindex dd03ebc..3b8f77d 100644[m
[1m--- a/src/page/index.vue[m
[1m+++ b/src/page/index.vue[m
[36m@@ -434,8 +434,6 @@[m
 								}[m
 							}[m
 							if( val.解决方式 && !v.$api.isEmptyObj(val.解决方式)){[m
[31m-								v.resolve_pieData.series[0].data[1].value += val.解决方式.robot;[m
[31m-								v.resolve_pieData.series[0].data[0].value += val.解决方式.human;[m
 								v.totalData.机器人解决量 += val.解决方式.robot;[m
 								v.totalData.人工解决量 += val.解决方式.human;[m
 							}[m
[36m@@ -461,12 +459,6 @@[m
 						v.totalData.总会话时长 = (会话时长.all/60).toFixed(0);[m
 						v.totalData.平均会话时长 = (会话时长.all/(v.totalData.总会话量||1)/60).toFixed(1);[m
 						[m
[31m-						v.resolve_pieData.series[0].label.normal.formatter = (v.resolve_pieData.series[0].data[1].value/((v.resolve_pieData.series[0].data[1].value+v.resolve_pieData.series[0].data[0].value)||1)*100).toFixed(2)+"%";[m
[31m-						[m
[31m-						/*let 机器人表现评分 = v.机器人表现评分(data.resolution*100,data.match_count/data.bot_dialogue*100,data.satisfaction,data.session).toFixed(2);[m
[31m-						v.satisfaction_gaugeOPtion.series[0].label.normal.formatter =机器人表现评分+'%';[m
[31m-						v.satisfaction_gaugeOPtion.series[0].data[0].value = 100-机器人表现评分;[m
[31m-						v.satisfaction_gaugeOPtion.series[0].data[1].value = 机器人表现评分;*/[m
 						[m
 					})[m
 			},[m

[33mcommit 5419a0e0864842d4d09dfac062ff0a202b3a9768[m
Author: lijianhui <jianhuili@webot.co>
Date:   Tue Sep 19 20:29:16 2017 +0800

    合并打包

[1mdiff --git a/dist.zip b/dist.zip[m
[1mindex 5fa9307..ae01eb8 100644[m
Binary files a/dist.zip and b/dist.zip differ

[33mcommit bcc7df107e98385fb02a6a0f31c95d6916c2d818[m
Merge: 81051c5 2650014
Author: lijianhui <jianhuili@webot.co>
Date:   Tue Sep 19 20:25:50 2017 +0800

    0

[33mcommit 81051c599a5903b7e83927fe781cd444eaa90988[m
Author: lijianhui <jianhuili@webot.co>
Date:   Tue Sep 19 20:17:46 2017 +0800

    首页修改

[1mdiff --git a/index.html b/index.html[m
[1mindex 42770b0..1f5c4d2 100644[m
[1m--- a/index.html[m
[1m+++ b/index.html[m
[36m@@ -6,6 +6,7 @@[m
     <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />[m
     <meta content="always" name="referrer">[m
     <link rel="shortcut icon" type="image/x-icon" href="favicon.ico" media="screen" />[m
[32m+[m[32m    <link rel="stylesheet" href="http://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" />[m
     <title>智言数据管理平台</title>[m
     <script>[m
     	<!--[if IE]> [m
[1mdiff --git a/src/App.vue b/src/App.vue[m
[1mindex b726d70..83b08d8 100644[m
[1m--- a/src/App.vue[m
[1m+++ b/src/App.vue[m
[36m@@ -144,7 +144,7 @@[m [mexport default {[m
   	#content { width:1000px;}[m
   }*/[m
   [m
[31m-  #content .header {height:70px; background:#fff;text-align:right;box-shadow:1px 0px 5px #ccc;}[m
[32m+[m[32m  #content .header {height:70px; background:#fff;text-align:right;box-shadow:1px 0px 5px #ccc; position:relative; z-index:10;}[m
   #content .header .username {display:inline-block;vertical-align: middle; width:70px;overflow:hidden;word-break:keep-all;white-space:nowrap;text-overflow:ellipsis;}[m
   #content .header .username + span {vertical-align: middle;}[m
   #content .header .select_model {display:inline-block; position:relative; top:25px; right:20px;;}[m
[1mdiff --git a/src/page/index.vue b/src/page/index.vue[m
[1mindex 3ee92e1..dd03ebc 100644[m
[1m--- a/src/page/index.vue[m
[1m+++ b/src/page/index.vue[m
[36m@@ -1,6 +1,6 @@[m
 <template>[m
[31m-	<div id="home">[m
[31m-		<div id="subNav">[m
[32m+[m	[32m<div class="home">[m
[32m+[m		[32m<div id="subNav" class="headers">[m
 			<div class="clearfix">[m
 				<h3 class="welcome">欢迎您{{getUser.username}}</h3>[m
 				[m
[36m@@ -8,73 +8,105 @@[m
 		</div>[m
 [m
 		<div class="main" style="overflow:hidden;">[m
[31m-			<div>[m
[31m-				<h2>数据总览</h2>[m
[31m-				<div class="row" >[m
[31m-					<div class="col-md-3 text-center">[m
[31m-						<div class="box_info boxShadow_1_1_8_5_f3">[m
[31m-							<div>[m
[31m-								<h3>正在咨询人数</h3>[m
[31m-								<strong>{{totalData['正在咨询人数']}}</strong>[m
[31m-							</div>[m
[31m-							<div>[m
[31m-								<p>当前在线客服：{{totalData['在线客服数']}}</p>[m
[32m+[m			[32m<div class="row">[m
[32m+[m				[32m<div class="box col-md-12">[m
[32m+[m					[32m<h2>数据总览</h2>[m
[32m+[m					[32m<div class="row" >[m
[32m+[m						[32m<div class="col-md-3 text-center">[m
[32m+[m							[32m<div class="box_info ">[m
[32m+[m								[32m<div>[m
[32m+[m									[32m<h3>正在咨询人数</h3>[m
[32m+[m									[32m<strong>{{totalData['正在咨询人数']}}</strong>[m
[32m+[m								[32m</div>[m
[32m+[m								[32m<div>[m
[32m+[m									[32m<p>当前在线客服：{{totalData['在线客服数']}}</p>[m
[32m+[m								[32m</div>[m
 							</div>[m
 						</div>[m
[31m-					</div>[m
[31m-					<div class="col-md-3 text-center">[m
[31m-						<div class="box_info boxShadow_1_1_8_5_f3">[m
[31m-							<div>[m
[31m-								<h3>今日总会话时长（分钟）</h3>[m
[31m-								<strong>{{totalData['总会话时长']}}</strong>[m
[31m-							</div>[m
[31m-							<div>[m
[31m-								<p>今日平均会话时长（分钟）：{{totalData['平均会话时长']}}</p>[m
[32m+[m						[32m<div class="col-md-3 text-center">[m
[32m+[m							[32m<div class="box_info ">[m
[32m+[m								[32m<div>[m
[32m+[m									[32m<h3>今日总会话时长（分钟）</h3>[m
[32m+[m									[32m<strong>{{totalData['总会话时长']}}</strong>[m
[32m+[m								[32m</div>[m
[32m+[m								[32m<div>[m
[32m+[m									[32m<p>今日平均会话时长（分钟）：{{totalData['平均会话时长']}}</p>[m
[32m+[m								[32m</div>[m
 							</div>[m
 						</div>[m
[31m-					</div>[m
[31m-					<div class="col-md-3 text-center">[m
[31m-						<div class="box_info boxShadow_1_1_8_5_f3">[m
[31m-							<div>[m
[31m-								<h3>总会话量</h3>[m
[31m-								<strong>{{totalData['总会话量']}}</strong>[m
[31m-							</div>[m
[31m-							<div>[m
[31m-								<p>解决量：{{totalData['机器人解决量']+totalData['人工解决量']}}</p>[m
[32m+[m						[32m<div class="col-md-3 text-center">[m
[32m+[m							[32m<div class="box_info ">[m
[32m+[m								[32m<div>[m
[32m+[m									[32m<h3>总会话量</h3>[m
[32m+[m									[32m<strong>{{totalData['总会话量']}}</strong>[m
[32m+[m								[32m</div>[m
[32m+[m								[32m<div>[m
[32m+[m									[32m<p>解决量：{{totalData['机器人解决量']+totalData['人工解决量']}}</p>[m
[32m+[m								[32m</div>[m
 							</div>[m
 						</div>[m
[31m-					</div>[m
[31m-					<div class="col-md-3 text-center">[m
[31m-						<div class="box_info boxShadow_1_1_8_5_f3">[m
[31m-							<div>[m
[31m-								<h3>今日相对满意度</h3>[m
[31m-								<strong>{{totalData['满意度'].toFixed(2)}}%</strong>[m
[31m-							</div>[m
[31m-							<div>[m
[31m-								<p>参评率：{{totalData['参评率'].toFixed(2)}}%</p>[m
[32m+[m						[32m<div class="col-md-3 text-center">[m
[32m+[m							[32m<div class="box_info ">[m
[32m+[m								[32m<div>[m
[32m+[m									[32m<h3>今日相对满意度</h3>[m
[32m+[m									[32m<strong>{{totalData['满意度'].toFixed(2)}}%</strong>[m
[32m+[m								[32m</div>[m
[32m+[m								[32m<div>[m
[32m+[m									[32m<p>参评率：{{totalData['参评率'].toFixed(2)}}%</p>[m
[32m+[m								[32m</div>[m
 							</div>[m
 						</div>[m
 					</div>[m
[32m+[m[41m	[m
 				</div>[m
[31m-[m
 			</div>[m
[31m-			<div class="clearfix">[m
[31m-				<div class="col-lg-12 col-md-12">[m
[31m-					<h2>机器人解决率</h2>[m
[31m-					<div class="box2 boxShadow_1_1_8_5_f3" style="width:100%; height:400px;">    [m
[31m-						<chart :options="resolve_pieData" :auto-resize="true"></chart>[m
[31m-						<!--<div class="QoQ">环比<span class="red">+16%↑</span></div>-->[m
[31m-					</div>[m
[31m-				</div>[m
[31m-				<div class="col-lg-12 col-md-12">[m
[32m+[m[41m			[m
[32m+[m			[32m<div class="row">[m
[32m+[m				[32m<div class="box col-lg-9 col-md-9 col-lg-offset-1">[m
 					<h2>今日在线服务数据趋势</h2>[m
[31m-					<div class="box2 boxShadow_1_1_8_5_f3" style="width:100%; height:400px;">[m
[32m+[m					[32m<div class="box2" style="width:100%; height:300px;">[m
 						<chart :options="会话量_option" :auto-resize="true" style="width:100%; height:100%"></chart>[m
 					</div>[m
 				</div>[m
[32m+[m				[32m<div class="box col-lg-3 col-md-3 resolve-rate">[m
[32m+[m					[32m<h2>机器人解决率</h2>[m
[32m+[m					[32m<div class="box2" style="width:100%; height:300px;">[m
[32m+[m						[32m<h4 class="human"><i class="fa fa-circle-o"></i>&nbsp;人工客服解决</h4>[m
[32m+[m						[32m<p>{{(totalData.人工解决量/((totalData.人工解决量+totalData.机器人解决量)||1)*100).toFixed(0)}}%</p>[m
[32m+[m						[32m<h4 class="robot"><i class="fa fa-circle-o"></i>&nbsp;机器人解决</h4>[m
[32m+[m						[32m<p>{{(totalData.机器人解决量/((totalData.人工解决量+totalData.机器人解决量)||1)*100).toFixed(0)}}%</p>[m
[32m+[m					[32m</div>[m
[32m+[m[41m					[m
[32m+[m				[32m</div>[m
 			</div>[m
[32m+[m			[32m<div class="row">[m
[32m+[m				[32m<div class="box col-lg-12 col-md-12">[m
[32m+[m					[32m<h2>今日客服活动</h2>[m
[32m+[m					[32m<table >[m
[32m+[m						[32m<tr>[m
[32m+[m							[32m<th>客服</th>[m
[32m+[m							[32m<th>在线状态</th>[m
[32m+[m							[32m<th>当前接待量</th>[m
[32m+[m							[32m<!--<th>累计会话量</th>[m
[32m+[m							[32m<th>累计消息量</th>[m
[32m+[m							[32m<th>相对满意度</th>[m
[32m+[m							[32m<th>首次在线时间</th>[m
[32m+[m							[32m<th>累计在线时间</th>-->[m
[32m+[m						[32m</tr>[m
[32m+[m						[32m<tbody>[m
[32m+[m							[32m<tr v-for="kf in kfs">[m
[32m+[m								[32m<td><i class="fa fa-user"></i>&nbsp;{{kf.姓名}}</td>[m
[32m+[m								[32m<td><i class="o" :class="kf.在线状态=='在线'?'online':''"></i>&nbsp;{{kf.在线状态}}</td>[m
[32m+[m								[32m<td>{{kf.当前接待量}}</td>[m
[32m+[m							[32m</tr>[m
[32m+[m						[32m</tbody>[m
[32m+[m					[32m</table>[m
[32m+[m				[32m</div>[m[41m	[m
[32m+[m			[32m</div>[m
[32m+[m[41m			[m
[32m+[m[41m			[m
 <!--假数据-->[m
[31m-			<div>[m
[32m+[m			[32m<!--<div>[m
 				<h2>客服数据</h2>[m
 				<div class="row" >[m
 					<div class="col-md-3 text-center">[m
[36m@@ -131,7 +163,7 @@[m
 						</div>[m
 					</div>[m
 				</div>[m
[31m-			</div>[m
[32m+[m			[32m</div>-->[m
 <!--假数据-->[m
 		</div>[m
 	</div>[m
[36m@@ -147,7 +179,7 @@[m
 		mixins:[图表],[m
 		data() {[m
 			return {[m
[31m-				show_loading: 0,[m
[32m+[m				[32mkfs:[],[m
 				totalData: {[m
 					'参评率': 0,[m
 					'在线客服数':0,[m
[36m@@ -185,91 +217,6 @@[m
 					满意度:0,[m
 					参评率:0,[m
 				},[m
[31m-				resolve_pieData: {[m
[31m-					tooltip: {[m
[31m-						trigger: 'item',[m
[31m-						formatter: "{a} <br/>{b} : {c} ({d}%)"[m
[31m-					},[m
[31m-					legend: {[m
[31m-						orient: 'horizontal',[m
[31m-						left: 'left',[m
[31m-						top: 30,[m
[31m-						itemWidth: 15,[m
[31m-						itemHeight: 15,[m
[31m-						data: ['人工客服解决', '机器人解决'][m
[31m-					},[m
[31m-					series: [{[m
[31m-						name: '解决率',[m
[31m-						type: 'pie',[m
[31m-						radius: ['55%', '65%'],[m
[31m-						avoidLabelOverlap: false,[m
[31m-						label: {[m
[31m-							normal: {[m
[31m-								show: true,[m
[31m-								position: "center",[m
[31m-								formatter: '0%',[m
[31m-								textStyle: {[m
[31m-									color: '#2bb3f3',[m
[31m-									fontSize: 50[m
[31m-								}[m
[31m-							},[m
[31m-							emphasis: {[m
[31m-								show: false,[m
[31m-							}[m
[31m-						},[m
[31m-						center: ['50%', '55%'],[m
[31m-						clockwise: false,[m
[31m-						data: [[m
[31m-							{ value: 0, name: '人工客服解决' },[m
[31m-							{ value: 0, name: '机器人解决' },[m
[31m-						],[m
[31m-						itemStyle: {[m
[31m-							emphasis: {[m
[31m-								shadowBlur: 10,[m
[31m-								shadowOffsetX: 0,[m
[31m-								shadowColor: 'rgba(0, 0, 0, 0.5)'[m
[31m-							}[m
[31m-						}[m
[31m-					}],[m
[31m-					color: ['#c688f6', '#7ae0ff'],[m
[31m-				},[m
[31m-				satisfaction_gaugeOPtion: {[m
[31m-					series: [{[m
[31m-						name: '解决率',[m
[31m-						type: 'pie',[m
[31m-						radius: ['55%', '65%'],[m
[31m-						avoidLabelOverlap: false,[m
[31m-						label: {[m
[31m-							normal: {[m
[31m-								show: true,[m
[31m-								position: "center",[m
[31m-								formatter: '0%',[m
[31m-								textStyle: {[m
[31m-									color: '#FFC156',[m
[31m-									fontSize: 50[m
[31m-								}[m
[31m-							},[m
[31m-							emphasis: {[m
[31m-								show: false,[m
[31m-							}[m
[31m-						},[m
[31m-						silent: true,[m
[31m-						clockwise: false,[m
[31m-						center: ['50%', '55%'],[m
[31m-						data: [[m
[31m-							{ value: 0, name: '满意率' },[m
[31m-							{ value: 0, name: '' },[m
[31m-						],[m
[31m-						itemStyle: {[m
[31m-							emphasis: {[m
[31m-								shadowBlur: 10,[m
[31m-								shadowOffsetX: 0,[m
[31m-								shadowColor: 'rgba(0, 0, 0, 0.5)'[m
[31m-							}[m
[31m-						}[m
[31m-					}],[m
[31m-					color: ['#f6f8f9', '#FFC156'],[m
[31m-				},[m
 				会话量_option:{[m
 					color:['#ecc55d','#77bff1','#e08d8d'],[m
 		        	tooltip: {[m
[36m@@ -365,6 +312,13 @@[m
 						v.清除数据痕迹();[m
 						//排序[m
 						let data = result.result;[m
[32m+[m						[32mresult.kf.forEach((val,i)=>{[m
[32m+[m							[32mif(val.在线状态=='在线'){[m
[32m+[m								[32mv.totalData.在线客服数 += 1;[m
[32m+[m							[32m}[m
[32m+[m							[32mv.kfs.push(val);[m
[32m+[m						[32m})[m
[32m+[m						[32mv.totalData.正在咨询人数 = result.chat;[m
 						for(let i=0;i<data.length;i++){[m
 							for(let j=i+1;j<data.length;j++){[m
 								if(data[i].created>data[j].created){[m
[36m@@ -378,8 +332,7 @@[m
 						let days = 1;[m
 						let hours = data.length;[m
 [m
[31m-						v.totalData.正在咨询人数 = result.chat;[m
[31m-						v.totalData.在线客服数 = result.kf;[m
[32m+[m[41m						[m
 						[m
 						v.totalData.参评率 = 0;[m
 						v.totalData.总会话量 = 0;[m
[36m@@ -550,42 +503,65 @@[m
 		}[m
 	}[m
 </script>[m
[31m-<style>[m
[31m-	#subNav {[m
[31m-		height: 80px;[m
[31m-	}[m
[31m-	[m
[31m-	[m
[31m-	#home {[m
[31m-		background: #f6f8f9;[m
[31m-	}[m
[31m-	[m
[31m-	#home .welcome {[m
[31m-		font-size: 16px;[m
[31m-		margin-left: 30px;[m
[31m-		display: inline;[m
[31m-	}[m
[31m-	[m
[31m-	#home .main h2 {[m
[31m-		text-align: center;[m
[31m-		color: #c6c7c8;[m
[31m-		font-size: 25px;[m
[31m-		line-height: 70px;[m
[31m-		margin-top: 20px;[m
[31m-	}[m
[31m-	[m
[31m-	#home .main h2 span {[m
[31m-		font-size: 14px;[m
[32m+[m[32m<style lang="scss">[m
[32m+[m	[32m.home {[m
[32m+[m		[32m.headers {[m
[32m+[m			[32mheight: 80px;[m
[32m+[m			[32m.welcome  {[m
[32m+[m				[32mfont-size: 16px;[m
[32m+[m				[32mmargin-left: 30px;[m
[32m+[m				[32mdisplay: inline;[m
[32m+[m			[32m}[m
[32m+[m		[32m}[m
[32m+[m		[32m.main{[m
[32m+[m			[32mpadding:20px 40px;[m
[32m+[m			[32m.box {[m
[32m+[m				[32mpadding:20px;[m[41m [m
[32m+[m				[32mmargin:15px 0; background:#fff;  @extend .boxShadow_1_1_3_3_f3;[m
[32m+[m				[32mh2{line-height:40px;border-bottom:1px solid #eee; margin-bottom:10px;}[m
[32m+[m				[32m.box_info {[m
[32m+[m					[32mdisplay: inline-block;[m
[32m+[m					[32mwidth: 250px;[m
[32m+[m					[32mpadding: 20px 0 0;[m
[32m+[m					[32mmargin: 10px;[m
[32m+[m					[32mbackground: #fff;[m
[32m+[m					[32mbox-shadow: 1px 1px 2px 2px #f3f3f3;[m
[32m+[m				[32m}[m
[32m+[m				[32mtable {[m
[32m+[m					[32mwidth:100%;border:1px solid #e2e2e2;[m
[32m+[m					[32mtr{[m
[32m+[m						[32mth {line-height:40px; padding:0 15px;background:#f9f9f9;}[m
[32m+[m					[32m}[m
[32m+[m					[32mtbody {[m
[32m+[m						[32mtr {[m
[32m+[m							[32mborder-top:1px solid #e2e2e2;[m
[32m+[m							[32mtd {padding:0 15px; line-height:40px;}[m
[32m+[m						[32m}[m
[32m+[m					[32m}[m
[32m+[m					[32m.fa-user {color:#89c997;}[m
[32m+[m					[32m.o {[m
[32m+[m						[32mdisplay:inline-block;width:8px; height:8px; background:#d0d0d0; border-radius:10px;[m
[32m+[m						[32m&.online {background:#41db3d;}[m
[32m+[m					[32m}[m
[32m+[m				[32m}[m
[32m+[m			[32m}[m
[32m+[m			[32m.resolve-rate {[m
[32m+[m				[32mmargin-left:20px;[m
[32m+[m				[32mwidth:calc(25% - 20px);[m
[32m+[m				[32mh4 {line-height:70px;}[m
[32m+[m				[32mp {font-size:55px; text-align:center;}[m
[32m+[m				[32m.human {[m
[32m+[m					[32mi {color:#f47171;}[m
[32m+[m					[32m& + p {color:#f47171;}[m
[32m+[m				[32m}[m
[32m+[m				[32m.robot {[m
[32m+[m					[32mi {color:#2b94ff;}[m
[32m+[m					[32m& + p {color:#2b94ff;}[m
[32m+[m				[32m}[m
[32m+[m			[32m}[m
[32m+[m		[32m}[m
 	}[m
 	[m
[31m-	.box_info {[m
[31m-		display: inline-block;[m
[31m-		width: 250px;[m
[31m-		padding: 20px 0 0;[m
[31m-		margin: 10px;[m
[31m-		background: #fff;[m
[31m-		box-shadow: 1px 1px 8px 5px #f3f3f3;[m
[31m-	}[m
 	[m
 	.box_info>div:first-child {[m
 		text-align: center;[m
[36m@@ -613,14 +589,7 @@[m
 		line-height: 40px;[m
 		color: #999;[m
 	}[m
[31m-	[m
[31m-	#home .box2 {[m
[31m-		border-top: 5px solid #2bb3f3;[m
[31m-		background: #fff;[m
[31m-		margin: 0 auto;[m
[31m-		position: relative;[m
[31m-	}[m
[31m-	[m
[32m+[m
 	.box2 .QoQ {[m
 		position: absolute;[m
 		bottom: 10px;[m
[36m@@ -632,7 +601,7 @@[m
 		font-size: 20px;[m
 	}[m
 	[m
[31m-	.boxShadow_1_1_8_5_f3 {[m
[31m-		box-shadow: 1px 1px 8px 5px #f3f3f3;[m
[32m+[m	[32m.boxShadow_1_1_3_3_f3 {[m
[32m+[m		[32mbox-shadow: 1px 1px 3px 3px #f3f3f3;[m
 	}[m
 </style>[m
\ No newline at end of file[m
[1mdiff --git a/src/page/mixin/图表.js b/src/page/mixin/图表.js[m
[1mindex bd3a8a2..aecf34d 100644[m
[1m--- a/src/page/mixin/图表.js[m
[1m+++ b/src/page/mixin/图表.js[m
[36m@@ -9,7 +9,7 @@[m [mexport default {[m
   	methods:{[m
   		fn_mixin计算折线或柱状图的最大值(value){  [m
         	if(value.max<10){[m
[31m-        		return value.max+2;[m
[32m+[m[41m        [m		[32mreturn value.max<5?value.max+5:value.max+2;[m
         	}else{[m
         		let digit = 1,max=value.max;[m
         		while(max>10){[m
[1mdiff --git a/src/page/module/subNav.vue b/src/page/module/subNav.vue[m
[1mindex f277f51..2ce7cea 100644[m
[1m--- a/src/page/module/subNav.vue[m
[1m+++ b/src/page/module/subNav.vue[m
[36m@@ -40,7 +40,7 @@[m
 	}[m
 </script>[m
 <style>[m
[31m-	#subNav { padding:19px 0 18px; height:70px; min-width:700px; position:absolute; left:0; top:-0px; background: white}[m
[32m+[m	[32m#subNav { padding:19px 0 18px; height:70px; min-width:700px; position:absolute; left:0; top:-0px; background: white; z-index:15;}[m
 	#subNav ul.nav2 {display:inline-block; background: #fff; border-radius:5px; margin:3px 3px 3px 20px; overflow:hidden;}[m
 	#subNav ul.nav2 li a {font-size:20px; color:#2bb3f3; padding:2px 10px; display:inline-block; text-decoration:none;}[m
 	#subNav ul.nav2 li.active a{ color:#fff;  background:#2bb3f3; border-radius:5px;}[m
[1mdiff --git a/src/page/rebotKnowledgeStore/knowledgeStore.vue b/src/page/rebotKnowledgeStore/knowledgeStore.vue[m
[1mindex c4042f8..f3018c6 100644[m
[1m--- a/src/page/rebotKnowledgeStore/knowledgeStore.vue[m
[1m+++ b/src/page/rebotKnowledgeStore/knowledgeStore.vue[m
[36m@@ -638,7 +638,7 @@[m [mexport default {[m
 }[m
 </script>[m
 <style>[m
[31m-	.wrap {display:flex;background:#f6f8f9; position:relative; }[m
[32m+[m	[32m.wrap {display:flex; position:relative; }[m
 	.classify {width:180px; overflow:hidden; }[m
 	.classify .wrapper {max-height:calc(100vh - 100px);}[m
 	classify::-webkit-scrollbar {width:1px; background:red;}[m

[33mcommit af5141a986a487b7b9cbd14445e4672d0cce0602[m
Author: lijianhui <jianhuili@webot.co>
Date:   Tue Sep 19 17:43:32 2017 +0800

    部分bug修复-color

[1mdiff --git a/src/page/user/account.vue b/src/page/user/account.vue[m
[1mindex 81b8dba..fd06626 100644[m
[1m--- a/src/page/user/account.vue[m
[1m+++ b/src/page/user/account.vue[m
[36m@@ -287,5 +287,5 @@[m
 	#account .tables {width:98%; margin:1%;}[m
 	#account input[type='radio'] {margin:0;}[m
 	#account .action {margin: 15px 15px 0;}[m
[31m-	.hover_c_13a0e3:hover {color:#13a073;}[m
[32m+[m	[32m.hover_c_13a0e3:hover {color:#13a0e3;}[m
 </style>[m
\ No newline at end of file[m
